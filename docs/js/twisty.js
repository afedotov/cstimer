var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(a,b,c,d){if(b){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var g=a[d];g in c||(c[g]={});c=c[g]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};$jscomp.polyfill("Array.prototype.fill",function(a){return a?a:function(a,c,d){var b=this.length||0;0>c&&(c=Math.max(0,b+c));if(null==d||d>b)d=b;d=Number(d);0>d&&(d=Math.max(0,b+d));for(c=Number(c||0);c<d;c++)this[c]=a;return this}},"es6","es3");
var THREE=THREE||{};window.Int32Array||(window.Int32Array=Array,window.Float32Array=Array);THREE.Color=function(a){this.setHex(a)};
THREE.Color.prototype={copy:function(a){this.r=a.r;this.g=a.g;this.b=a.b;this.hex=a.hex},setHex:function(a){this.hex=~~a&16777215;this.updateRGB()},setRGB:function(a,b,c){this.r=a;this.g=b;this.b=c;this.updateHex()},setHSV:function(a,b,c){var d,g;if(0==c)var h=d=g=0;else{var f=Math.floor(6*a);var l=6*a-f;a=c*(1-b);var n=c*(1-b*l);b=c*(1-b*(1-l));switch(f){case 1:h=n;d=c;g=a;break;case 2:h=a;d=c;g=b;break;case 3:h=a;d=n;g=c;break;case 4:h=b;d=a;g=c;break;case 5:h=c;d=a;g=n;break;case 6:case 0:h=c,
d=b,g=a}}this.setRGB(h,d,g)},updateHex:function(){this.hex=~~(255*this.r)<<16^~~(255*this.g)<<8^~~(255*this.b)},updateRGB:function(){this.r=(this.hex>>16&255)/255;this.g=(this.hex>>8&255)/255;this.b=(this.hex&255)/255},clone:function(){return new THREE.Color(this.hex)}};THREE.Vector2=function(a,b){this.set(a||0,b||0)};
THREE.Vector2.prototype={set:function(a,b){this.x=a;this.y=b;return this},copy:function(a){this.x=a.x;this.y=a.y;return this},clone:function(){return new THREE.Vector2(this.x,this.y)},add:function(a,b){this.x=a.x+b.x;this.y=a.y+b.y;return this},addSelf:function(a){this.x+=a.x;this.y+=a.y;return this},sub:function(a,b){this.x=a.x-b.x;this.y=a.y-b.y;return this},subSelf:function(a){this.x-=a.x;this.y-=a.y;return this},multiplyScalar:function(a){this.x*=a;this.y*=a;return this},divideScalar:function(a){a?
(this.x/=a,this.y/=a):this.set(0,0);return this},negate:function(){return this.multiplyScalar(-1)},dot:function(a){return this.x*a.x+this.y*a.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.lengthSq())},normalize:function(){return this.divideScalar(this.length())},setLength:function(a){return this.normalize().multiplyScalar(a)},unit:function(){return this.normalize()}};THREE.Vector3=function(a,b,c){this.set(a||0,b||0,c||0)};
THREE.Vector3.prototype={set:function(a,b,c){this.x=a;this.y=b;this.z=c;return this},copy:function(a){this.x=a.x;this.y=a.y;this.z=a.z;return this},clone:function(){return new THREE.Vector3(this.x,this.y,this.z)},add:function(a,b){this.x=a.x+b.x;this.y=a.y+b.y;this.z=a.z+b.z;return this},addSelf:function(a){this.x+=a.x;this.y+=a.y;this.z+=a.z;return this},addScalar:function(a){this.x+=a;this.y+=a;this.z+=a;return this},sub:function(a,b){this.x=a.x-b.x;this.y=a.y-b.y;this.z=a.z-b.z;return this},subSelf:function(a){this.x-=
a.x;this.y-=a.y;this.z-=a.z;return this},multiply:function(a,b){this.x=a.x*b.x;this.y=a.y*b.y;this.z=a.z*b.z;return this},multiplySelf:function(a){this.x*=a.x;this.y*=a.y;this.z*=a.y;return this},multiplyScalar:function(a){this.x*=a;this.y*=a;this.z*=a;return this},divideSelf:function(a){return this.divide(this,a)},divideScalar:function(a){a?(this.x/=a,this.y/=a,this.z/=a):this.set(0,0,0);return this},negate:function(){return this.multiplyScalar(-1)},dot:function(a){return this.x*a.x+this.y*a.y+this.z*
a.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.lengthSq())},lengthManhattan:function(){return this.x+this.y+this.z},normalize:function(){return this.divideScalar(this.length())},setLength:function(a){return this.normalize().multiplyScalar(a)},cross:function(a,b){this.x=a.y*b.z-a.z*b.y;this.y=a.z*b.x-a.x*b.z;this.z=a.x*b.y-a.y*b.x;return this},crossSelf:function(a){return this.set(this.y*a.z-this.z*a.y,this.z*a.x-this.x*a.z,this.x*
a.y-this.y*a.x)},distanceTo:function(a){return Math.sqrt(this.distanceToSquared(a))},distanceToSquared:function(a){return(new THREE.Vector3).sub(this,a).lengthSq()},setPositionFromMatrix:function(a){this.x=a.n14;this.y=a.n24;this.z=a.n34},setRotationFromMatrix:function(a){var b=Math.cos(this.y);this.y=Math.asin(a.n13);1E-5<Math.abs(b)?(this.x=Math.atan2(-a.n23/b,a.n33/b),this.z=Math.atan2(-a.n12/b,a.n11/b)):(this.x=0,this.z=Math.atan2(a.n21,a.n22))},isZero:function(){return 1E-4>this.lengthSq()}};
THREE.Vector4=function(a,b,c,d){this.set(a||0,b||0,c||0,d||1)};
THREE.Vector4.prototype={set:function(a,b,c,d){this.x=a;this.y=b;this.z=c;this.w=d;return this},copy:function(a){return this.set(a.x,a.y,a.z,a.w||1)},clone:function(){return new THREE.Vector4(this.x,this.y,this.z,this.w)},add:function(a,b){this.x=a.x+b.x;this.y=a.y+b.y;this.z=a.z+b.z;this.w=a.w+b.w;return this},addSelf:function(a){this.x+=a.x;this.y+=a.y;this.z+=a.z;this.w+=a.w;return this},sub:function(a,b){this.x=a.x-b.x;this.y=a.y-b.y;this.z=a.z-b.z;this.w=a.w-b.w;return this},subSelf:function(a){this.x-=
a.x;this.y-=a.y;this.z-=a.z;this.w-=a.w;return this},multiplyScalar:function(a){this.x*=a;this.y*=a;this.z*=a;this.w*=a;return this},divideScalar:function(a){a?(this.x/=a,this.y/=a,this.z/=a,this.w/=a):this.set(0,0,0,1);return this},negate:function(){return this.multiplyScalar(-1)},dot:function(a){return this.x*a.x+this.y*a.y+this.z*a.z+this.w*a.w},lengthSq:function(){return this.dot(this)},length:function(){return Math.sqrt(this.lengthSq())},normalize:function(){return this.divideScalar(this.length())},
setLength:function(a){return this.normalize().multiplyScalar(a)},lerpSelf:function(a,b){this.x+=(a.x-this.x)*b;this.y+=(a.y-this.y)*b;this.z+=(a.z-this.z)*b;this.w+=(a.w-this.w)*b;return this}};THREE.Ray=function(a,b){this.origin=a||new THREE.Vector3;this.direction=b||new THREE.Vector3};
THREE.Ray.prototype={intersectScene:function(a){return this.intersectObjects(a.objects)},intersectObjects:function(a){var b,c=[];var d=0;for(b=a.length;d<b;d++)c=c.concat(this.intersectObject(a[d]));c.sort(function(a,b){return a.distance-b.distance});return c},intersectObject:function(a){function b(a,b,c){var d=c.position.clone().subSelf(a).dot(b);if(0>d)return!1;a=a.clone().addSelf(b.clone().multiplyScalar(d));return c.position.distanceTo(a)}function c(a,b,c,d){d=d.clone().subSelf(b);c=c.clone().subSelf(b);
var g=a.clone().subSelf(b);a=d.dot(d);b=d.dot(c);d=d.dot(g);var f=c.dot(c);c=c.dot(g);g=1/(a*f-b*b);f=(f*d-b*c)*g;a=(a*c-b*d)*g;return 0<f&&0<a&&1>f+a}if(a instanceof THREE.Particle){var d=b(this.origin,this.direction,a);return!d||d>a.scale.x?[]:[{distance:d,point:a.position,face:null,object:a}]}if(a instanceof THREE.Mesh){d=b(this.origin,this.direction,a);if(!d||d>a.geometry.boundingSphere.radius*Math.max(a.scale.x,Math.max(a.scale.y,a.scale.z)))return[];var g,h=a.geometry,f=h.vertices,l=[];d=0;
for(g=h.faces.length;d<g;d++){var n=h.faces[d];var k=this.origin.clone();var u=this.direction.clone();var r=a.matrixWorld;var w=r.multiplyVector3(f[n.a].position.clone());var z=r.multiplyVector3(f[n.b].position.clone());var m=r.multiplyVector3(f[n.c].position.clone());r=n instanceof THREE.Face4?r.multiplyVector3(f[n.d].position.clone()):null;var A=a.matrixRotationWorld.multiplyVector3(n.normal.clone());var C=u.dot(A);if(a.doubleSided||(a.flipSided?0<C:0>C))A=A.dot((new THREE.Vector3).sub(w,k))/C,
k=k.addSelf(u.multiplyScalar(A)),n instanceof THREE.Face3?c(k,w,z,m)&&(n={distance:this.origin.distanceTo(k),point:k,face:n,object:a},l.push(n)):n instanceof THREE.Face4&&(c(k,w,z,r)||c(k,z,m,r))&&(n={distance:this.origin.distanceTo(k),point:k,face:n,object:a},l.push(n))}return l}return[]}};
THREE.Rectangle=function(){function a(){h=d-b;f=g-c}var b,c,d,g,h,f,l=!0;this.getX=function(){return b};this.getY=function(){return c};this.getWidth=function(){return h};this.getHeight=function(){return f};this.getLeft=function(){return b};this.getTop=function(){return c};this.getRight=function(){return d};this.getBottom=function(){return g};this.set=function(f,h,u,r){l=!1;b=f;c=h;d=u;g=r;a()};this.addPoint=function(f,h){l?(l=!1,b=f,c=h,d=f,g=h):(b=b<f?b:f,c=c<h?c:h,d=d>f?d:f,g=g>h?g:h);a()};this.add3Points=
function(f,h,u,r,w,z){l?(l=!1,b=f<u?f<w?f:w:u<w?u:w,c=h<r?h<z?h:z:r<z?r:z,d=f>u?f>w?f:w:u>w?u:w,g=h>r?h>z?h:z:r>z?r:z):(b=f<u?f<w?f<b?f:b:w<b?w:b:u<w?u<b?u:b:w<b?w:b,c=h<r?h<z?h<c?h:c:z<c?z:c:r<z?r<c?r:c:z<c?z:c,d=f>u?f>w?f>d?f:d:w>d?w:d:u>w?u>d?u:d:w>d?w:d,g=h>r?h>z?h>g?h:g:z>g?z:g:r>z?r>g?r:g:z>g?z:g);a()};this.addRectangle=function(f){l?(l=!1,b=f.getLeft(),c=f.getTop(),d=f.getRight(),g=f.getBottom()):(b=b<f.getLeft()?b:f.getLeft(),c=c<f.getTop()?c:f.getTop(),d=d>f.getRight()?d:f.getRight(),g=g>
f.getBottom()?g:f.getBottom());a()};this.inflate=function(f){b-=f;c-=f;d+=f;g+=f;a()};this.minSelf=function(f){b=b>f.getLeft()?b:f.getLeft();c=c>f.getTop()?c:f.getTop();d=d<f.getRight()?d:f.getRight();g=g<f.getBottom()?g:f.getBottom();a()};this.instersects=function(a){return 0<=Math.min(d,a.getRight())-Math.max(b,a.getLeft())&&0<=Math.min(g,a.getBottom())-Math.max(c,a.getTop())};this.empty=function(){l=!0;g=d=c=b=0;a()};this.isEmpty=function(){return l}};THREE.Matrix3=function(){this.m=[]};
THREE.Matrix3.prototype={transpose:function(){var a=this.m;var b=a[1];a[1]=a[3];a[3]=b;b=a[2];a[2]=a[6];a[6]=b;b=a[5];a[5]=a[7];a[7]=b;return this},transposeIntoArray:function(a){var b=this.m;a[0]=b[0];a[1]=b[3];a[2]=b[6];a[3]=b[1];a[4]=b[4];a[5]=b[7];a[6]=b[2];a[7]=b[5];a[8]=b[8];return this}};THREE.Matrix4=function(a,b,c,d,g,h,f,l,n,k,u,r,w,z,m,A){this.set(a||1,b||0,c||0,d||0,g||0,h||1,f||0,l||0,n||0,k||0,u||1,r||0,w||0,z||0,m||0,A||1);this.flat=Array(16);this.m33=new THREE.Matrix3};
THREE.Matrix4.prototype={set:function(a,b,c,d,g,h,f,l,n,k,u,r,w,z,m,A){this.n11=a;this.n12=b;this.n13=c;this.n14=d;this.n21=g;this.n22=h;this.n23=f;this.n24=l;this.n31=n;this.n32=k;this.n33=u;this.n34=r;this.n41=w;this.n42=z;this.n43=m;this.n44=A;return this},identity:function(){this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return this},copy:function(a){this.set(a.n11,a.n12,a.n13,a.n14,a.n21,a.n22,a.n23,a.n24,a.n31,a.n32,a.n33,a.n34,a.n41,a.n42,a.n43,a.n44);return this},lookAt:function(a,b,c){var d=THREE.Matrix4.__v1,
g=THREE.Matrix4.__v2,h=THREE.Matrix4.__v3;h.sub(a,b).normalize();0===h.length()&&(h.z=1);d.cross(c,h).normalize();0===d.length()&&(h.x+=1E-4,d.cross(c,h).normalize());g.cross(h,d).normalize();this.n11=d.x;this.n12=g.x;this.n13=h.x;this.n21=d.y;this.n22=g.y;this.n23=h.y;this.n31=d.z;this.n32=g.z;this.n33=h.z;return this},multiplyVector3:function(a){var b=a.x,c=a.y,d=a.z,g=1/(this.n41*b+this.n42*c+this.n43*d+this.n44);a.x=(this.n11*b+this.n12*c+this.n13*d+this.n14)*g;a.y=(this.n21*b+this.n22*c+this.n23*
d+this.n24)*g;a.z=(this.n31*b+this.n32*c+this.n33*d+this.n34)*g;return a},multiplyVector4:function(a){var b=a.x,c=a.y,d=a.z,g=a.w;a.x=this.n11*b+this.n12*c+this.n13*d+this.n14*g;a.y=this.n21*b+this.n22*c+this.n23*d+this.n24*g;a.z=this.n31*b+this.n32*c+this.n33*d+this.n34*g;a.w=this.n41*b+this.n42*c+this.n43*d+this.n44*g;return a},rotateAxis:function(a){var b=a.x,c=a.y,d=a.z;a.x=b*this.n11+c*this.n12+d*this.n13;a.y=b*this.n21+c*this.n22+d*this.n23;a.z=b*this.n31+c*this.n32+d*this.n33;a.normalize();
return a},crossVector:function(a){var b=new THREE.Vector4;b.x=this.n11*a.x+this.n12*a.y+this.n13*a.z+this.n14*a.w;b.y=this.n21*a.x+this.n22*a.y+this.n23*a.z+this.n24*a.w;b.z=this.n31*a.x+this.n32*a.y+this.n33*a.z+this.n34*a.w;b.w=a.w?this.n41*a.x+this.n42*a.y+this.n43*a.z+this.n44*a.w:1;return b},multiply:function(a,b){var c=a.n11,d=a.n12,g=a.n13,h=a.n14,f=a.n21,l=a.n22,n=a.n23,k=a.n24,u=a.n31,r=a.n32,w=a.n33,z=a.n34,m=a.n41,A=a.n42,C=a.n43,F=a.n44,O=b.n11,I=b.n12,D=b.n13,q=b.n14,p=b.n21,v=b.n22,
t=b.n23,G=b.n24,B=b.n31,J=b.n32,E=b.n33,Q=b.n34;this.n11=c*O+d*p+g*B;this.n12=c*I+d*v+g*J;this.n13=c*D+d*t+g*E;this.n14=c*q+d*G+g*Q+h;this.n21=f*O+l*p+n*B;this.n22=f*I+l*v+n*J;this.n23=f*D+l*t+n*E;this.n24=f*q+l*G+n*Q+k;this.n31=u*O+r*p+w*B;this.n32=u*I+r*v+w*J;this.n33=u*D+r*t+w*E;this.n34=u*q+r*G+w*Q+z;this.n41=m*O+A*p+C*B;this.n42=m*I+A*v+C*J;this.n43=m*D+A*t+C*E;this.n44=m*q+A*G+C*Q+F;return this},multiplyToArray:function(a,b,c){this.multiply(a,b);c[0]=this.n11;c[1]=this.n21;c[2]=this.n31;c[3]=
this.n41;c[4]=this.n12;c[5]=this.n22;c[6]=this.n32;c[7]=this.n42;c[8]=this.n13;c[9]=this.n23;c[10]=this.n33;c[11]=this.n43;c[12]=this.n14;c[13]=this.n24;c[14]=this.n34;c[15]=this.n44;return this},multiplySelf:function(a){this.multiply(this,a);return this},multiplyScalar:function(a){this.n11*=a;this.n12*=a;this.n13*=a;this.n14*=a;this.n21*=a;this.n22*=a;this.n23*=a;this.n24*=a;this.n31*=a;this.n32*=a;this.n33*=a;this.n34*=a;this.n41*=a;this.n42*=a;this.n43*=a;this.n44*=a;return this},determinant:function(){var a=
this.n11,b=this.n12,c=this.n13,d=this.n14,g=this.n21,h=this.n22,f=this.n23,l=this.n24,n=this.n31,k=this.n32,u=this.n33,r=this.n34,w=this.n41,z=this.n42,m=this.n43,A=this.n44;return d*f*k*w-c*l*k*w-d*h*u*w+b*l*u*w+c*h*r*w-b*f*r*w-d*f*n*z+c*l*n*z+d*g*u*z-a*l*u*z-c*g*r*z+a*f*r*z+d*h*n*m-b*l*n*m-d*g*k*m+a*l*k*m+b*g*r*m-a*h*r*m-c*h*n*A+b*f*n*A+c*g*k*A-a*f*k*A-b*g*u*A+a*h*u*A},transpose:function(){var a=this.n21;this.n21=this.n12;this.n12=a;a=this.n31;this.n31=this.n13;this.n13=a;a=this.n32;this.n32=this.n23;
this.n23=a;a=this.n41;this.n41=this.n14;this.n14=a;a=this.n42;this.n42=this.n24;this.n24=a;this.n43=a=this.n43;return this},clone:function(){var a=new THREE.Matrix4;a.n11=this.n11;a.n12=this.n12;a.n13=this.n13;a.n14=this.n14;a.n21=this.n21;a.n22=this.n22;a.n23=this.n23;a.n24=this.n24;a.n31=this.n31;a.n32=this.n32;a.n33=this.n33;a.n34=this.n34;a.n41=this.n41;a.n42=this.n42;a.n43=this.n43;a.n44=this.n44;return a},flatten:function(){this.flat[0]=this.n11;this.flat[1]=this.n21;this.flat[2]=this.n31;this.flat[3]=
this.n41;this.flat[4]=this.n12;this.flat[5]=this.n22;this.flat[6]=this.n32;this.flat[7]=this.n42;this.flat[8]=this.n13;this.flat[9]=this.n23;this.flat[10]=this.n33;this.flat[11]=this.n43;this.flat[12]=this.n14;this.flat[13]=this.n24;this.flat[14]=this.n34;this.flat[15]=this.n44;return this.flat},flattenToArray:function(a){a[0]=this.n11;a[1]=this.n21;a[2]=this.n31;a[3]=this.n41;a[4]=this.n12;a[5]=this.n22;a[6]=this.n32;a[7]=this.n42;a[8]=this.n13;a[9]=this.n23;a[10]=this.n33;a[11]=this.n43;a[12]=this.n14;
a[13]=this.n24;a[14]=this.n34;a[15]=this.n44;return a},flattenToArrayOffset:function(a,b){a[b]=this.n11;a[b+1]=this.n21;a[b+2]=this.n31;a[b+3]=this.n41;a[b+4]=this.n12;a[b+5]=this.n22;a[b+6]=this.n32;a[b+7]=this.n42;a[b+8]=this.n13;a[b+9]=this.n23;a[b+10]=this.n33;a[b+11]=this.n43;a[b+12]=this.n14;a[b+13]=this.n24;a[b+14]=this.n34;a[b+15]=this.n44;return a},setTranslation:function(a,b,c){this.set(1,0,0,a,0,1,0,b,0,0,1,c,0,0,0,1);return this},setScale:function(a,b,c){this.set(a,0,0,0,0,b,0,0,0,0,c,
0,0,0,0,1);return this},setRotationX:function(a){var b=Math.cos(a);a=Math.sin(a);this.set(1,0,0,0,0,b,-a,0,0,a,b,0,0,0,0,1);return this},setRotationY:function(a){var b=Math.cos(a);a=Math.sin(a);this.set(b,0,a,0,0,1,0,0,-a,0,b,0,0,0,0,1);return this},setRotationZ:function(a){var b=Math.cos(a);a=Math.sin(a);this.set(b,-a,0,0,a,b,0,0,0,0,1,0,0,0,0,1);return this},setRotationAxis:function(a,b){var c=Math.cos(b),d=Math.sin(b),g=1-c,h=a.x,f=a.y,l=a.z,n=g*h,k=g*f;this.set(n*h+c,n*f-d*l,n*l+d*f,0,n*f+d*l,
k*f+c,k*l-d*h,0,n*l-d*f,k*l+d*h,g*l*l+c,0,0,0,0,1);return this},setPosition:function(a){this.n14=a.x;this.n24=a.y;this.n34=a.z;return this},getPosition:function(){this.position||(this.position=new THREE.Vector3);this.position.set(this.n14,this.n24,this.n34);return this.position},getColumnX:function(){this.columnX||(this.columnX=new THREE.Vector3);this.columnX.set(this.n11,this.n21,this.n31);return this.columnX},getColumnY:function(){this.columnY||(this.columnY=new THREE.Vector3);this.columnY.set(this.n12,
this.n22,this.n32);return this.columnY},getColumnZ:function(){this.columnZ||(this.columnZ=new THREE.Vector3);this.columnZ.set(this.n13,this.n23,this.n33);return this.columnZ},setRotationFromEuler:function(a){var b=a.x,c=a.y,d=a.z;a=Math.cos(b);b=Math.sin(b);var g=Math.cos(c);c=Math.sin(c);var h=Math.cos(d);d=Math.sin(d);var f=a*c,l=b*c;this.n11=g*h;this.n12=-g*d;this.n13=c;this.n21=l*h+a*d;this.n22=-l*d+a*h;this.n23=-b*g;this.n31=-f*h+b*d;this.n32=f*d+b*h;this.n33=a*g;return this},setRotationFromQuaternion:function(a){var b=
a.x,c=a.y,d=a.z,g=a.w,h=b+b,f=c+c,l=d+d;a=b*h;var n=b*f;b*=l;var k=c*f;c*=l;d*=l;h*=g;f*=g;g*=l;this.n11=1-(k+d);this.n12=n-g;this.n13=b+f;this.n21=n+g;this.n22=1-(a+d);this.n23=c-h;this.n31=b-f;this.n32=c+h;this.n33=1-(a+k);return this},scale:function(a){var b=a.x,c=a.y;a=a.z;this.n11*=b;this.n12*=c;this.n13*=a;this.n21*=b;this.n22*=c;this.n23*=a;this.n31*=b;this.n32*=c;this.n33*=a;this.n41*=b;this.n42*=c;this.n43*=a;return this},extractPosition:function(a){this.n14=a.n14;this.n24=a.n24;this.n34=
a.n34},extractRotation:function(a,b){var c=1/b.x,d=1/b.y,g=1/b.z;this.n11=a.n11*c;this.n21=a.n21*c;this.n31=a.n31*c;this.n12=a.n12*d;this.n22=a.n22*d;this.n32=a.n32*d;this.n13=a.n13*g;this.n23=a.n23*g;this.n33=a.n33*g}};
THREE.Matrix4.makeInvert=function(a,b){var c=a.n11,d=a.n12,g=a.n13,h=a.n14,f=a.n21,l=a.n22,n=a.n23,k=a.n24,u=a.n31,r=a.n32,w=a.n33,z=a.n34,m=a.n41,A=a.n42,C=a.n43,F=a.n44;void 0===b&&(b=new THREE.Matrix4);b.n11=n*z*A-k*w*A+k*r*C-l*z*C-n*r*F+l*w*F;b.n12=h*w*A-g*z*A-h*r*C+d*z*C+g*r*F-d*w*F;b.n13=g*k*A-h*n*A+h*l*C-d*k*C-g*l*F+d*n*F;b.n14=h*n*r-g*k*r-h*l*w+d*k*w+g*l*z-d*n*z;b.n21=k*w*m-n*z*m-k*u*C+f*z*C+n*u*F-f*w*F;b.n22=g*z*m-h*w*m+h*u*C-c*z*C-g*u*F+c*w*F;b.n23=h*n*m-g*k*m-h*f*C+c*k*C+g*f*F-c*n*F;b.n24=
g*k*u-h*n*u+h*f*w-c*k*w-g*f*z+c*n*z;b.n31=l*z*m-k*r*m+k*u*A-f*z*A-l*u*F+f*r*F;b.n32=h*r*m-d*z*m-h*u*A+c*z*A+d*u*F-c*r*F;b.n33=g*k*m-h*l*m+h*f*A-c*k*A-d*f*F+c*l*F;b.n34=h*l*u-d*k*u-h*f*r+c*k*r+d*f*z-c*l*z;b.n41=n*r*m-l*w*m-n*u*A+f*w*A+l*u*C-f*r*C;b.n42=d*w*m-g*r*m+g*u*A-c*w*A-d*u*C+c*r*C;b.n43=g*l*m-d*n*m-g*f*A+c*n*A+d*f*C-c*l*C;b.n44=d*n*u-g*l*u+g*f*r-c*n*r-d*f*w+c*l*w;b.multiplyScalar(1/a.determinant());return b};
THREE.Matrix4.makeInvert3x3=function(a){var b=a.m33,c=b.m,d=a.n33*a.n22-a.n32*a.n23,g=-a.n33*a.n21+a.n31*a.n23,h=a.n32*a.n21-a.n31*a.n22,f=-a.n33*a.n12+a.n32*a.n13,l=a.n33*a.n11-a.n31*a.n13,n=-a.n32*a.n11+a.n31*a.n12,k=a.n23*a.n12-a.n22*a.n13,u=-a.n23*a.n11+a.n21*a.n13,r=a.n22*a.n11-a.n21*a.n12;a=a.n11*d+a.n21*f+a.n31*k;0==a&&console.error("THREE.Matrix4.makeInvert3x3: Matrix not invertible.");a=1/a;c[0]=a*d;c[1]=a*g;c[2]=a*h;c[3]=a*f;c[4]=a*l;c[5]=a*n;c[6]=a*k;c[7]=a*u;c[8]=a*r;return b};
THREE.Matrix4.makeFrustum=function(a,b,c,d,g,h){var f=new THREE.Matrix4;f.n11=2*g/(b-a);f.n12=0;f.n13=(b+a)/(b-a);f.n14=0;f.n21=0;f.n22=2*g/(d-c);f.n23=(d+c)/(d-c);f.n24=0;f.n31=0;f.n32=0;f.n33=-(h+g)/(h-g);f.n34=-2*h*g/(h-g);f.n41=0;f.n42=0;f.n43=-1;f.n44=0;return f};THREE.Matrix4.makePerspective=function(a,b,c,d){a=c*Math.tan(a*Math.PI/360);var g=-a;return THREE.Matrix4.makeFrustum(g*b,a*b,g,a,c,d)};
THREE.Matrix4.makeOrtho=function(a,b,c,d,g,h){var f=new THREE.Matrix4;var l=b-a;var n=c-d;var k=h-g;f.n11=2/l;f.n12=0;f.n13=0;f.n14=-((b+a)/l);f.n21=0;f.n22=2/n;f.n23=0;f.n24=-((c+d)/n);f.n31=0;f.n32=0;f.n33=-2/k;f.n34=-((h+g)/k);f.n41=0;f.n42=0;f.n43=0;f.n44=1;return f};THREE.Matrix4.__v1=new THREE.Vector3;THREE.Matrix4.__v2=new THREE.Vector3;THREE.Matrix4.__v3=new THREE.Vector3;
THREE.Object3D=function(){this.parent=void 0;this.children=[];this.up=new THREE.Vector3(0,1,0);this.position=new THREE.Vector3;this.rotation=new THREE.Vector3;this.scale=new THREE.Vector3(1,1,1);this.dynamic=!1;this.rotationAutoUpdate=!0;this.matrix=new THREE.Matrix4;this.matrixWorld=new THREE.Matrix4;this.matrixRotationWorld=new THREE.Matrix4;this.matrixWorldNeedsUpdate=this.matrixAutoUpdate=!0;this.quaternion=new THREE.Quaternion;this.useQuaternion=!1;this.boundRadius=0;this.boundRadiusScale=1;
this.visible=!0;this._vector=new THREE.Vector3;this.name=""};
THREE.Object3D.prototype={translate:function(a,b){this.matrix.rotateAxis(b);this.position.addSelf(b.multiplyScalar(a))},translateX:function(a){this.translate(a,this._vector.set(1,0,0))},translateY:function(a){this.translate(a,this._vector.set(0,1,0))},translateZ:function(a){this.translate(a,this._vector.set(0,0,1))},lookAt:function(a){this.matrix.lookAt(a,this.position,this.up);this.rotationAutoUpdate&&this.rotation.setRotationFromMatrix(this.matrix)},addChild:function(a){if(-1===this.children.indexOf(a)){void 0!==
a.parent&&a.parent.removeChild(a);a.parent=this;this.children.push(a);for(var b=this;void 0!==b.parent;)b=b.parent;void 0!==b&&b instanceof THREE.Scene&&b.addChildRecurse(a)}},removeChild:function(a){var b=this.children.indexOf(a);-1!==b&&(a.parent=void 0,this.children.splice(b,1))},getChildByName:function(a,b){var c;var d=0;for(c=this.children.length;d<c;d++){var g=this.children[d];if(g.name===a||b&&(g=g.getChildByName(a,b),void 0!==g))return g}},updateMatrix:function(){this.matrix.setPosition(this.position);
this.useQuaternion?this.matrix.setRotationFromQuaternion(this.quaternion):this.matrix.setRotationFromEuler(this.rotation);if(1!==this.scale.x||1!==this.scale.y||1!==this.scale.z)this.matrix.scale(this.scale),this.boundRadiusScale=Math.max(this.scale.x,Math.max(this.scale.y,this.scale.z));this.matrixWorldNeedsUpdate=!0},update:function(a,b,c){this.matrixAutoUpdate&&this.updateMatrix();if(this.matrixWorldNeedsUpdate||b)a?this.matrixWorld.multiply(a,this.matrix):this.matrixWorld.copy(this.matrix),this.matrixRotationWorld.extractRotation(this.matrixWorld,
this.scale),this.matrixWorldNeedsUpdate=!1,b=!0;a=0;for(var d=this.children.length;a<d;a++)this.children[a].update(this.matrixWorld,b,c)}};THREE.Quaternion=function(a,b,c,d){this.set(a||0,b||0,c||0,void 0!==d?d:1)};
THREE.Quaternion.prototype={set:function(a,b,c,d){this.x=a;this.y=b;this.z=c;this.w=d;return this},copy:function(a){this.x=a.x;this.y=a.y;this.z=a.z;this.w=a.w;return this},setFromEuler:function(a){var b=.5*Math.PI/360,c=a.x*b,d=a.y*b,g=a.z*b;a=Math.cos(d);d=Math.sin(d);b=Math.cos(-g);g=Math.sin(-g);var h=Math.cos(c);c=Math.sin(c);var f=a*b,l=d*g;this.w=f*h-l*c;this.x=f*c+l*h;this.y=d*b*h+a*g*c;this.z=a*g*h-d*b*c;return this},setFromAxisAngle:function(a,b){var c=b/2,d=Math.sin(c);this.x=a.x*d;this.y=
a.y*d;this.z=a.z*d;this.w=Math.cos(c);return this},calculateW:function(){this.w=-Math.sqrt(Math.abs(1-this.x*this.x-this.y*this.y-this.z*this.z));return this},inverse:function(){this.x*=-1;this.y*=-1;this.z*=-1;return this},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},normalize:function(){var a=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);0==a?this.w=this.z=this.y=this.x=0:(a=1/a,this.x*=a,this.y*=a,this.z*=a,this.w*=a);return this},
multiplySelf:function(a){var b=this.x,c=this.y,d=this.z,g=this.w,h=a.x,f=a.y,l=a.z;a=a.w;this.x=b*a+g*h+c*l-d*f;this.y=c*a+g*f+d*h-b*l;this.z=d*a+g*l+b*f-c*h;this.w=g*a-b*h-c*f-d*l;return this},multiply:function(a,b){this.x=a.x*b.w+a.y*b.z-a.z*b.y+a.w*b.x;this.y=-a.x*b.z+a.y*b.w+a.z*b.x+a.w*b.y;this.z=a.x*b.y-a.y*b.x+a.z*b.w+a.w*b.z;this.w=-a.x*b.x-a.y*b.y-a.z*b.z+a.w*b.w;return this},multiplyVector3:function(a,b){b||(b=a);var c=a.x,d=a.y,g=a.z,h=this.x,f=this.y,l=this.z,n=this.w,k=n*c+f*g-l*d,u=
n*d+l*c-h*g,r=n*g+h*d-f*c;c=-h*c-f*d-l*g;b.x=k*n+c*-h+u*-l-r*-f;b.y=u*n+c*-f+r*-h-k*-l;b.z=r*n+c*-l+k*-f-u*-h;return b}};THREE.Quaternion.slerp=function(a,b,c,d){var g=a.w*b.w+a.x*b.x+a.y*b.y+a.z*b.z;if(1<=Math.abs(g))return c.w=a.w,c.x=a.x,c.y=a.y,c.z=a.z,c;var h=Math.acos(g),f=Math.sqrt(1-g*g);if(.001>Math.abs(f))return c.w=.5*(a.w+b.w),c.x=.5*(a.x+b.x),c.y=.5*(a.y+b.y),c.z=.5*(a.z+b.z),c;g=Math.sin((1-d)*h)/f;d=Math.sin(d*h)/f;c.w=a.w*g+b.w*d;c.x=a.x*g+b.x*d;c.y=a.y*g+b.y*d;c.z=a.z*g+b.z*d;return c};
THREE.Vertex=function(a){this.position=a||new THREE.Vector3};THREE.Face3=function(a,b,c,d,g,h){this.a=a;this.b=b;this.c=c;this.normal=d instanceof THREE.Vector3?d:new THREE.Vector3;this.vertexNormals=d instanceof Array?d:[];this.color=g instanceof THREE.Color?g:new THREE.Color;this.vertexColors=g instanceof Array?g:[];this.vertexTangents=[];this.materials=h instanceof Array?h:[h];this.centroid=new THREE.Vector3};
THREE.Face4=function(a,b,c,d,g,h,f){this.a=a;this.b=b;this.c=c;this.d=d;this.normal=g instanceof THREE.Vector3?g:new THREE.Vector3;this.vertexNormals=g instanceof Array?g:[];this.color=h instanceof THREE.Color?h:new THREE.Color;this.vertexColors=h instanceof Array?h:[];this.vertexTangents=[];this.materials=f instanceof Array?f:[f];this.centroid=new THREE.Vector3};THREE.UV=function(a,b){this.set(a||0,b||0)};
THREE.UV.prototype={set:function(a,b){this.u=a;this.v=b;return this},copy:function(a){this.set(a.u,a.v);return this}};THREE.Geometry=function(){this.id="Geometry"+THREE.GeometryIdCounter++;this.vertices=[];this.colors=[];this.faces=[];this.edges=[];this.faceUvs=[[]];this.faceVertexUvs=[[]];this.morphTargets=[];this.morphColors=[];this.skinWeights=[];this.skinIndices=[];this.boundingSphere=this.boundingBox=null;this.hasTangents=!1};
THREE.Geometry.prototype={computeCentroids:function(){var a;var b=0;for(a=this.faces.length;b<a;b++){var c=this.faces[b];c.centroid.set(0,0,0);c instanceof THREE.Face3?(c.centroid.addSelf(this.vertices[c.a].position),c.centroid.addSelf(this.vertices[c.b].position),c.centroid.addSelf(this.vertices[c.c].position),c.centroid.divideScalar(3)):c instanceof THREE.Face4&&(c.centroid.addSelf(this.vertices[c.a].position),c.centroid.addSelf(this.vertices[c.b].position),c.centroid.addSelf(this.vertices[c.c].position),
c.centroid.addSelf(this.vertices[c.d].position),c.centroid.divideScalar(4))}},computeFaceNormals:function(a){var b,c,d=new THREE.Vector3,g=new THREE.Vector3;var h=0;for(c=this.faces.length;h<c;h++){var f=this.faces[h];if(a&&f.vertexNormals.length){d.set(0,0,0);var l=0;for(b=f.vertexNormals.length;l<b;l++)d.addSelf(f.vertexNormals[l]);d.divideScalar(3)}else{l=this.vertices[f.a];b=this.vertices[f.b];var n=this.vertices[f.c];d.sub(n.position,b.position);g.sub(l.position,b.position);d.crossSelf(g)}d.isZero()||
d.normalize();f.normal.copy(d)}},computeVertexNormals:function(){var a;if(void 0==this.__tmpVertices){var b=this.__tmpVertices=Array(this.vertices.length);var c=0;for(a=this.vertices.length;c<a;c++)b[c]=new THREE.Vector3;c=0;for(a=this.faces.length;c<a;c++){var d=this.faces[c];d instanceof THREE.Face3?d.vertexNormals=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3]:d instanceof THREE.Face4&&(d.vertexNormals=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3])}}else for(b=
this.__tmpVertices,c=0,a=this.vertices.length;c<a;c++)b[c].set(0,0,0);c=0;for(a=this.faces.length;c<a;c++)d=this.faces[c],d instanceof THREE.Face3?(b[d.a].addSelf(d.normal),b[d.b].addSelf(d.normal),b[d.c].addSelf(d.normal)):d instanceof THREE.Face4&&(b[d.a].addSelf(d.normal),b[d.b].addSelf(d.normal),b[d.c].addSelf(d.normal),b[d.d].addSelf(d.normal));c=0;for(a=this.vertices.length;c<a;c++)b[c].normalize();c=0;for(a=this.faces.length;c<a;c++)d=this.faces[c],d instanceof THREE.Face3?(d.vertexNormals[0].copy(b[d.a]),
d.vertexNormals[1].copy(b[d.b]),d.vertexNormals[2].copy(b[d.c])):d instanceof THREE.Face4&&(d.vertexNormals[0].copy(b[d.a]),d.vertexNormals[1].copy(b[d.b]),d.vertexNormals[2].copy(b[d.c]),d.vertexNormals[3].copy(b[d.d]))},computeTangents:function(){function a(a,b,c,t,T,B,J){d=a.vertices[b].position;g=a.vertices[c].position;h=a.vertices[t].position;f=Q[T];l=Q[B];n=Q[J];k=g.x-d.x;u=h.x-d.x;r=g.y-d.y;w=h.y-d.y;z=g.z-d.z;m=h.z-d.z;A=l.u-f.u;C=n.u-f.u;F=l.v-f.v;O=n.v-f.v;I=1/(A*O-C*F);p.set((O*k-F*u)*
I,(O*r-F*w)*I,(O*z-F*m)*I);v.set((A*u-C*k)*I,(A*w-C*r)*I,(A*m-C*z)*I);D[b].addSelf(p);D[c].addSelf(p);D[t].addSelf(p);q[b].addSelf(v);q[c].addSelf(v);q[t].addSelf(v)}var b,c,d,g,h,f,l,n,k,u,r,w,z,m,A,C,F,O,I,D=[],q=[],p=new THREE.Vector3,v=new THREE.Vector3,t=new THREE.Vector3,G=new THREE.Vector3,B=new THREE.Vector3;var J=0;for(b=this.vertices.length;J<b;J++)D[J]=new THREE.Vector3,q[J]=new THREE.Vector3;J=0;for(b=this.faces.length;J<b;J++){var E=this.faces[J];var Q=this.faceVertexUvs[0][J];E instanceof
THREE.Face3?a(this,E.a,E.b,E.c,0,1,2):E instanceof THREE.Face4&&(a(this,E.a,E.b,E.c,0,1,2),a(this,E.a,E.b,E.d,0,1,3))}var M=["a","b","c","d"];J=0;for(b=this.faces.length;J<b;J++)for(E=this.faces[J],c=0;c<E.vertexNormals.length;c++){B.copy(E.vertexNormals[c]);var H=E[M[c]];var T=D[H];t.copy(T);t.subSelf(B.multiplyScalar(B.dot(T))).normalize();G.cross(E.vertexNormals[c],T);H=G.dot(q[H]);H=0>H?-1:1;E.vertexTangents[c]=new THREE.Vector4(t.x,t.y,t.z,H)}this.hasTangents=!0},computeBoundingBox:function(){if(0<
this.vertices.length){this.boundingBox={x:[this.vertices[0].position.x,this.vertices[0].position.x],y:[this.vertices[0].position.y,this.vertices[0].position.y],z:[this.vertices[0].position.z,this.vertices[0].position.z]};for(var a=1,b=this.vertices.length;a<b;a++){var c=this.vertices[a];c.position.x<this.boundingBox.x[0]?this.boundingBox.x[0]=c.position.x:c.position.x>this.boundingBox.x[1]&&(this.boundingBox.x[1]=c.position.x);c.position.y<this.boundingBox.y[0]?this.boundingBox.y[0]=c.position.y:
c.position.y>this.boundingBox.y[1]&&(this.boundingBox.y[1]=c.position.y);c.position.z<this.boundingBox.z[0]?this.boundingBox.z[0]=c.position.z:c.position.z>this.boundingBox.z[1]&&(this.boundingBox.z[1]=c.position.z)}}},computeBoundingSphere:function(){for(var a=0,b=0,c=this.vertices.length;b<c;b++)a=Math.max(a,this.vertices[b].position.length());this.boundingSphere={radius:a}},computeEdgeFaces:function(){function a(a,b){return Math.min(a,b)+"_"+Math.max(a,b)}function b(a,b,c){void 0===a[b]?(a[b]=
{set:{},array:[]},a[b].set[c]=1,a[b].array.push(c)):void 0===a[b].set[c]&&(a[b].set[c]=1,a[b].array.push(c))}var c,d={};var g=0;for(c=this.faces.length;g<c;g++){var h=this.faces[g];if(h instanceof THREE.Face3){var f=a(h.a,h.b);b(d,f,g);f=a(h.b,h.c);b(d,f,g);f=a(h.a,h.c);b(d,f,g)}else h instanceof THREE.Face4&&(f=a(h.b,h.d),b(d,f,g),f=a(h.a,h.b),b(d,f,g),f=a(h.a,h.d),b(d,f,g),f=a(h.b,h.c),b(d,f,g),f=a(h.c,h.d),b(d,f,g))}g=0;for(c=this.edges.length;g<c;g++){h=this.edges[g];f=h.vertexIndices[0];var l=
h.vertexIndices[1];h.faceIndices=d[a(f,l)].array;for(f=0;f<h.faceIndices.length;f++)l=h.faceIndices[f],h.faces.push(this.faces[l])}}};THREE.GeometryIdCounter=0;THREE.Camera=function(a,b,c,d,g){THREE.Object3D.call(this);this.fov=a||50;this.aspect=b||1;this.near=c||.1;this.far=d||2E3;this.target=g||new THREE.Object3D;this.useTarget=!0;this.matrixWorldInverse=new THREE.Matrix4;this.projectionMatrix=null;this.updateProjectionMatrix()};THREE.Camera.prototype=new THREE.Object3D;
THREE.Camera.prototype.constructor=THREE.Camera;THREE.Camera.prototype.supr=THREE.Object3D.prototype;THREE.Camera.prototype.translate=function(a,b){this.matrix.rotateAxis(b);this.position.addSelf(b.multiplyScalar(a));this.target.position.addSelf(b.multiplyScalar(a))};THREE.Camera.prototype.updateProjectionMatrix=function(){this.projectionMatrix=THREE.Matrix4.makePerspective(this.fov,this.aspect,this.near,this.far)};
THREE.Camera.prototype.update=function(a,b,c){if(this.useTarget)this.matrix.lookAt(this.position,this.target.position,this.up),this.matrix.setPosition(this.position),a?this.matrixWorld.multiply(a,this.matrix):this.matrixWorld.copy(this.matrix),THREE.Matrix4.makeInvert(this.matrixWorld,this.matrixWorldInverse),b=!0;else if(this.matrixAutoUpdate&&this.updateMatrix(),b||this.matrixWorldNeedsUpdate)a?this.matrixWorld.multiply(a,this.matrix):this.matrixWorld.copy(this.matrix),this.matrixWorldNeedsUpdate=
!1,b=!0,THREE.Matrix4.makeInvert(this.matrixWorld,this.matrixWorldInverse);for(a=0;a<this.children.length;a++)this.children[a].update(this.matrixWorld,b,c)};THREE.Light=function(a){THREE.Object3D.call(this);this.color=new THREE.Color(a)};THREE.Light.prototype=new THREE.Object3D;THREE.Light.prototype.constructor=THREE.Light;THREE.Light.prototype.supr=THREE.Object3D.prototype;
THREE.Material=function(a){this.id=THREE.MaterialCounter.value++;a=a||{};this.opacity=void 0!==a.opacity?a.opacity:1;this.transparent=void 0!==a.transparent?a.transparent:!1;this.blending=void 0!==a.blending?a.blending:THREE.NormalBlending;this.depthTest=void 0!==a.depthTest?a.depthTest:!0};THREE.NoShading=0;THREE.FlatShading=1;THREE.SmoothShading=2;THREE.NoColors=0;THREE.FaceColors=1;THREE.VertexColors=2;THREE.NormalBlending=0;THREE.AdditiveBlending=1;THREE.SubtractiveBlending=2;
THREE.MultiplyBlending=3;THREE.AdditiveAlphaBlending=4;THREE.MaterialCounter={value:0};
THREE.MeshBasicMaterial=function(a){THREE.Material.call(this,a);a=a||{};this.color=void 0!==a.color?new THREE.Color(a.color):new THREE.Color(16777215);this.map=void 0!==a.map?a.map:null;this.lightMap=void 0!==a.lightMap?a.lightMap:null;this.envMap=void 0!==a.envMap?a.envMap:null;this.combine=void 0!==a.combine?a.combine:THREE.MultiplyOperation;this.reflectivity=void 0!==a.reflectivity?a.reflectivity:1;this.refractionRatio=void 0!==a.refractionRatio?a.refractionRatio:.98;this.shading=void 0!==a.shading?
a.shading:THREE.SmoothShading;this.wireframe=void 0!==a.wireframe?a.wireframe:!1;this.wireframeLinewidth=void 0!==a.wireframeLinewidth?a.wireframeLinewidth:1;this.wireframeLinecap=void 0!==a.wireframeLinecap?a.wireframeLinecap:"round";this.wireframeLinejoin=void 0!==a.wireframeLinejoin?a.wireframeLinejoin:"round";this.vertexColors=void 0!==a.vertexColors?a.vertexColors:!1;this.skinning=void 0!==a.skinning?a.skinning:!1;this.morphTargets=void 0!==a.morphTargets?a.morphTargets:!1};
THREE.MeshBasicMaterial.prototype=new THREE.Material;THREE.MeshBasicMaterial.prototype.constructor=THREE.MeshBasicMaterial;THREE.MeshFaceMaterial=function(){};THREE.Particle=function(a){THREE.Object3D.call(this);this.materials=a instanceof Array?a:[a]};THREE.Particle.prototype=new THREE.Object3D;THREE.Particle.prototype.constructor=THREE.Particle;THREE.Line=function(a,b,c){THREE.Object3D.call(this);this.geometry=a;this.materials=b instanceof Array?b:[b];this.type=void 0!=c?c:THREE.LineStrip};
THREE.LineStrip=0;THREE.LinePieces=1;THREE.Line.prototype=new THREE.Object3D;THREE.Line.prototype.constructor=THREE.Line;
THREE.Mesh=function(a,b){THREE.Object3D.call(this);this.geometry=a;this.materials=b&&b.length?b:[b];this.overdraw=this.doubleSided=this.flipSided=!1;if(this.geometry&&(this.geometry.boundingSphere||this.geometry.computeBoundingSphere(),this.boundRadius=a.boundingSphere.radius,this.geometry.morphTargets.length)){this.morphTargetBase=-1;this.morphTargetForcedOrder=[];this.morphTargetInfluences=[];this.morphTargetDictionary={};for(var c=0;c<this.geometry.morphTargets.length;c++)this.morphTargetInfluences.push(0),
this.morphTargetDictionary[this.geometry.morphTargets[c].name]=c}};THREE.Mesh.prototype=new THREE.Object3D;THREE.Mesh.prototype.constructor=THREE.Mesh;THREE.Mesh.prototype.supr=THREE.Object3D.prototype;THREE.Mesh.prototype.getMorphTargetIndexByName=function(a){if(void 0!==this.morphTargetDictionary[a])return this.morphTargetDictionary[a];console.log("THREE.Mesh.getMorphTargetIndexByName: morph target "+a+" does not exist. Returning 0.");return 0};
THREE.Bone=function(a){THREE.Object3D.call(this);this.skin=a;this.skinMatrix=new THREE.Matrix4;this.hasNoneBoneChildren=!1};THREE.Bone.prototype=new THREE.Object3D;THREE.Bone.prototype.constructor=THREE.Bone;THREE.Bone.prototype.supr=THREE.Object3D.prototype;
THREE.Bone.prototype.update=function(a,b,c){this.matrixAutoUpdate&&(b|=this.updateMatrix());if(b||this.matrixWorldNeedsUpdate)a?this.skinMatrix.multiply(a,this.matrix):this.skinMatrix.copy(this.matrix),this.matrixWorldNeedsUpdate=!1,b=!0;var d,g=this.children.length;if(this.hasNoneBoneChildren)for(this.matrixWorld.multiply(this.skin.matrixWorld,this.skinMatrix),d=0;d<g;d++)a=this.children[d],a instanceof THREE.Bone?a.update(this.skinMatrix,b,c):a.update(this.matrixWorld,!0,c);else for(d=0;d<g;d++)this.children[d].update(this.skinMatrix,
b,c)};THREE.Bone.prototype.addChild=function(a){-1===this.children.indexOf(a)&&(void 0!==a.parent&&a.parent.removeChild(a),a.parent=this,this.children.push(a),a instanceof THREE.Bone||(this.hasNoneBoneChildren=!0))};
THREE.Sound=function(a,b,c,d){THREE.Object3D.call(this);this.isPlaying=this.isAddedToDOM=this.isLoaded=!1;this.duration=-1;this.radius=void 0!==b?Math.abs(b):100;this.volume=Math.min(1,Math.max(0,void 0!==c?c:1));this.domElement=document.createElement("audio");this.domElement.volume=0;this.domElement.pan=0;this.domElement.loop=void 0!==d?d:!0;this.sources=a instanceof Array?a:[a];var g;c=this.sources.length;for(a=0;a<c;a++)if(b=this.sources[a],b.toLowerCase(),-1!==b.indexOf(".mp3")?g="audio/mpeg":
-1!==b.indexOf(".ogg")?g="audio/ogg":-1!==b.indexOf(".wav")&&(g="audio/wav"),this.domElement.canPlayType(g)){g=document.createElement("source");g.src=this.sources[a];this.domElement.THREESound=this;this.domElement.appendChild(g);this.domElement.addEventListener("canplay",this.onLoad,!0);this.domElement.load();break}};THREE.Sound.prototype=new THREE.Object3D;THREE.Sound.prototype.constructor=THREE.Sound;THREE.Sound.prototype.supr=THREE.Object3D.prototype;
THREE.Sound.prototype.onLoad=function(){var a=this.THREESound;a.isLoaded||(this.removeEventListener("canplay",this.onLoad,!0),a.isLoaded=!0,a.duration=this.duration,a.isPlaying&&a.play())};THREE.Sound.prototype.addToDOM=function(a){this.isAddedToDOM=!0;a.appendChild(this.domElement)};THREE.Sound.prototype.play=function(a){this.isPlaying=!0;this.isLoaded&&(this.domElement.play(),a&&(this.domElement.currentTime=a%this.duration))};THREE.Sound.prototype.pause=function(){this.isPlaying=!1;this.domElement.pause()};
THREE.Sound.prototype.stop=function(){this.isPlaying=!1;this.domElement.pause();this.domElement.currentTime=0};THREE.Sound.prototype.calculateVolumeAndPan=function(a){a=a.length();this.domElement.volume=a<=this.radius?this.volume*(1-a/this.radius):0};
THREE.Sound.prototype.update=function(a,b,c){this.matrixAutoUpdate&&(this.matrix.setPosition(this.position),b=!0);if(b||this.matrixWorldNeedsUpdate)a?this.matrixWorld.multiply(a,this.matrix):this.matrixWorld.copy(this.matrix),this.matrixWorldNeedsUpdate=!1,b=!0;var d=this.children.length;for(a=0;a<d;a++)this.children[a].update(this.matrixWorld,b,c)};
THREE.Scene=function(){THREE.Object3D.call(this);this.matrixAutoUpdate=!1;this.collisions=this.fog=null;this.objects=[];this.lights=[];this.sounds=[];this.__objectsAdded=[];this.__objectsRemoved=[]};THREE.Scene.prototype=new THREE.Object3D;THREE.Scene.prototype.constructor=THREE.Scene;THREE.Scene.prototype.supr=THREE.Object3D.prototype;THREE.Scene.prototype.addChild=function(a){this.supr.addChild.call(this,a);this.addChildRecurse(a)};
THREE.Scene.prototype.addChildRecurse=function(a){a instanceof THREE.Light?-1===this.lights.indexOf(a)&&this.lights.push(a):a instanceof THREE.Sound?-1===this.sounds.indexOf(a)&&this.sounds.push(a):a instanceof THREE.Camera||a instanceof THREE.Bone||-1!==this.objects.indexOf(a)||(this.objects.push(a),this.__objectsAdded.push(a));for(var b=0;b<a.children.length;b++)this.addChildRecurse(a.children[b])};THREE.Scene.prototype.removeChild=function(a){this.supr.removeChild.call(this,a);this.removeChildRecurse(a)};
THREE.Scene.prototype.removeChildRecurse=function(a){if(a instanceof THREE.Light){var b=this.lights.indexOf(a);-1!==b&&this.lights.splice(b,1)}else a instanceof THREE.Sound?(b=this.sounds.indexOf(a),-1!==b&&this.sounds.splice(b,1)):a instanceof THREE.Camera||(b=this.objects.indexOf(a),-1!==b&&(this.objects.splice(b,1),this.__objectsRemoved.push(a)));for(b=0;b<a.children.length;b++)this.removeChildRecurse(a.children[b])};THREE.Scene.prototype.addObject=THREE.Scene.prototype.addChild;
THREE.Scene.prototype.removeObject=THREE.Scene.prototype.removeChild;THREE.Scene.prototype.addLight=THREE.Scene.prototype.addChild;THREE.Scene.prototype.removeLight=THREE.Scene.prototype.removeChild;
THREE.Projector=function(){function a(){var a=n[l]=n[l]||new THREE.RenderableVertex;l++;return a}function b(a,b){return b.z-a.z}function c(a,b){var c=0,d=1,f=a.z+a.w,g=b.z+b.w,h=-a.z+a.w,k=-b.z+b.w;if(0<=f&&0<=g&&0<=h&&0<=k)return!0;if(0>f&&0>g||0>h&&0>k)return!1;0>f?c=Math.max(c,f/(f-g)):0>g&&(d=Math.min(d,f/(f-g)));0>h?c=Math.max(c,h/(h-k)):0>k&&(d=Math.min(d,h/(h-k)));if(d<c)return!1;a.lerpSelf(b,c);b.lerpSelf(a,1-d);return!0}var d,g,h=[],f,l,n=[],k,u,r=[],w,z=[],m,A,C=[],F,O,I=[],D=new THREE.Vector4,
q=new THREE.Vector4,p=new THREE.Matrix4,v=new THREE.Matrix4,t=[new THREE.Vector4,new THREE.Vector4,new THREE.Vector4,new THREE.Vector4,new THREE.Vector4,new THREE.Vector4],G=new THREE.Vector4,B=new THREE.Vector4;this.projectVector=function(a,b){p.multiply(b.projectionMatrix,b.matrixWorldInverse);p.multiplyVector3(a);return a};this.unprojectVector=function(a,b){p.multiply(b.matrixWorld,THREE.Matrix4.makeInvert(b.projectionMatrix));p.multiplyVector3(a);return a};this.projectObjects=function(a,c,f){c=
[];var k;g=0;var l=a.objects;a=0;for(k=l.length;a<k;a++){var q=l[a];var m;if(!(m=!q.visible)&&(m=q instanceof THREE.Mesh)){a:{for(var v=q.matrixWorld,n=-q.geometry.boundingSphere.radius*Math.max(q.scale.x,Math.max(q.scale.y,q.scale.z)),B=0;6>B;B++)if(m=t[B].x*v.n14+t[B].y*v.n24+t[B].z*v.n34+t[B].w,m<=n){m=!1;break a}m=!0}m=!m}m||(m=h[g]=h[g]||new THREE.RenderableObject,g++,d=m,D.copy(q.position),p.multiplyVector3(D),d.object=q,d.z=D.z,c.push(d))}f&&c.sort(b);return c};this.projectScene=function(d,
g,h){var J=[],D=g.near,T=g.far,W,L;O=A=w=u=0;g.matrixAutoUpdate&&g.update(void 0,!0);d.update(void 0,!1,g);p.multiply(g.projectionMatrix,g.matrixWorldInverse);t[0].set(p.n41-p.n11,p.n42-p.n12,p.n43-p.n13,p.n44-p.n14);t[1].set(p.n41+p.n11,p.n42+p.n12,p.n43+p.n13,p.n44+p.n14);t[2].set(p.n41+p.n21,p.n42+p.n22,p.n43+p.n23,p.n44+p.n24);t[3].set(p.n41-p.n21,p.n42-p.n22,p.n43-p.n23,p.n44-p.n24);t[4].set(p.n41-p.n31,p.n42-p.n32,p.n43-p.n33,p.n44-p.n34);t[5].set(p.n41+p.n31,p.n42+p.n32,p.n43+p.n33,p.n44+p.n34);
for(W=0;6>W;W++){var N=t[W];N.divideScalar(Math.sqrt(N.x*N.x+N.y*N.y+N.z*N.z))}N=this.projectObjects(d,g,!0);d=0;for(W=N.length;d<W;d++){var P=N[d].object;if(P.visible){var X=P.matrixWorld;var ea=P.matrixRotationWorld;var Q=P.materials;var fa=P.overdraw;l=0;if(P instanceof THREE.Mesh){var ma=P.geometry;var R=ma.vertices;var aa=ma.faces;ma=ma.faceVertexUvs;var U=0;for(L=R.length;U<L;U++)f=a(),f.positionWorld.copy(R[U].position),X.multiplyVector3(f.positionWorld),f.positionScreen.copy(f.positionWorld),
p.multiplyVector4(f.positionScreen),f.positionScreen.x/=f.positionScreen.w,f.positionScreen.y/=f.positionScreen.w,f.visible=f.positionScreen.z>D&&f.positionScreen.z<T;R=0;for(U=aa.length;R<U;R++){L=aa[R];if(L instanceof THREE.Face3){var K=n[L.a];var S=n[L.b];var E=n[L.c];if(K.visible&&S.visible&&E.visible&&(P.doubleSided||P.flipSided!=0>(E.positionScreen.x-K.positionScreen.x)*(S.positionScreen.y-K.positionScreen.y)-(E.positionScreen.y-K.positionScreen.y)*(S.positionScreen.x-K.positionScreen.x))){var Y=
r[u]=r[u]||new THREE.RenderableFace3;u++;k=Y;k.v1.copy(K);k.v2.copy(S);k.v3.copy(E)}else continue}else if(L instanceof THREE.Face4)if(K=n[L.a],S=n[L.b],E=n[L.c],Y=n[L.d],K.visible&&S.visible&&E.visible&&Y.visible&&(P.doubleSided||P.flipSided!=(0>(Y.positionScreen.x-K.positionScreen.x)*(S.positionScreen.y-K.positionScreen.y)-(Y.positionScreen.y-K.positionScreen.y)*(S.positionScreen.x-K.positionScreen.x)||0>(S.positionScreen.x-E.positionScreen.x)*(Y.positionScreen.y-E.positionScreen.y)-(S.positionScreen.y-
E.positionScreen.y)*(Y.positionScreen.x-E.positionScreen.x)))){var ha=z[w]=z[w]||new THREE.RenderableFace4;w++;k=ha;k.v1.copy(K);k.v2.copy(S);k.v3.copy(E);k.v4.copy(Y)}else continue;k.normalWorld.copy(L.normal);ea.multiplyVector3(k.normalWorld);k.centroidWorld.copy(L.centroid);X.multiplyVector3(k.centroidWorld);k.centroidScreen.copy(k.centroidWorld);p.multiplyVector3(k.centroidScreen);E=L.vertexNormals;K=0;for(S=E.length;K<S;K++)Y=k.vertexNormalsWorld[K],Y.copy(E[K]),ea.multiplyVector3(Y);K=0;for(S=
ma.length;K<S;K++)if(ha=ma[K][R])for(E=0,Y=ha.length;E<Y;E++)k.uvs[K][E]=ha[E];k.meshMaterials=Q;k.faceMaterials=L.materials;k.overdraw=fa;k.z=k.centroidScreen.z;J.push(k)}}else if(P instanceof THREE.Line)for(v.multiply(p,X),R=P.geometry.vertices,K=a(),K.positionScreen.copy(R[0].position),v.multiplyVector4(K.positionScreen),U=1,L=R.length;U<L;U++)K=a(),K.positionScreen.copy(R[U].position),v.multiplyVector4(K.positionScreen),S=n[l-2],G.copy(K.positionScreen),B.copy(S.positionScreen),c(G,B)&&(G.multiplyScalar(1/
G.w),B.multiplyScalar(1/B.w),X=C[A]=C[A]||new THREE.RenderableLine,A++,m=X,m.v1.positionScreen.copy(G),m.v2.positionScreen.copy(B),m.z=Math.max(G.z,B.z),m.materials=P.materials,J.push(m));else P instanceof THREE.Particle&&(q.set(P.matrixWorld.n14,P.matrixWorld.n24,P.matrixWorld.n34,1),p.multiplyVector4(q),q.z/=q.w,0<q.z&&1>q.z&&(X=I[O]=I[O]||new THREE.RenderableParticle,O++,F=X,F.x=q.x/q.w,F.y=q.y/q.w,F.z=q.z,F.rotation=P.rotation.z,F.scale.x=P.scale.x*Math.abs(F.x-(q.x+g.projectionMatrix.n11)/(q.w+
g.projectionMatrix.n14)),F.scale.y=P.scale.y*Math.abs(F.y-(q.y+g.projectionMatrix.n22)/(q.w+g.projectionMatrix.n24)),F.materials=P.materials,J.push(F)))}}h&&J.sort(b);return J}};
THREE.CanvasRenderer=function(a){function b(a){F!=a&&(m.globalAlpha=F=a)}function c(a){if(O!=a){switch(a){case THREE.NormalBlending:m.globalCompositeOperation="source-over";break;case THREE.AdditiveBlending:m.globalCompositeOperation="lighter";break;case THREE.SubtractiveBlending:m.globalCompositeOperation="darker"}O=a}}function d(a){I!=a.hex&&(I=a.hex,m.strokeStyle="#"+h(I.toString(16)))}function g(a){D!=a.hex&&(D=a.hex,m.fillStyle="#"+h(D.toString(16)))}function h(a){for(;6>a.length;)a="0"+a;return a}
var f=this,l=null,n=new THREE.Projector;a=a||{};var k=void 0!==a.canvas?a.canvas:document.createElement("canvas"),u,r,w,z,m=k.getContext("2d"),A=new THREE.Color(0),C=0,F=1,O=0,I=null,D=null,q=null,p=null,v=null,t,G,B,J,E=new THREE.RenderableVertex,Q=new THREE.RenderableVertex,M,H,T,W,L,N,P,X,ea,la,fa,ma,R=new THREE.Color(0),aa=new THREE.Color(0),U=new THREE.Color(0),K=new THREE.Color(0),S=new THREE.Color(0),pa,Y,ha,ia,Ia,Ja,Ka,La,Ma,Na,ua=new THREE.Rectangle,ka=new THREE.Rectangle,da=new THREE.Rectangle,
Fa=!1,ja=new THREE.Color,ba=new THREE.Color,va=new THREE.Color,wa=new THREE.Color,Z=new THREE.Vector3;a=16;var Aa=document.createElement("canvas");Aa.width=Aa.height=2;var Ba=Aa.getContext("2d");Ba.fillStyle="rgba(0,0,0,1)";Ba.fillRect(0,0,2,2);var Oa=Ba.getImageData(0,0,2,2);var na=Oa.data;var Ca=document.createElement("canvas");Ca.width=Ca.height=a;var Ga=Ca.getContext("2d");Ga.translate(-a/2,-a/2);Ga.scale(a,a);a--;this.domElement=k;this.sortElements=this.sortObjects=this.autoClear=!0;this.data=
{vertices:0,faces:0};this.setSize=function(a,b){u=a;r=b;w=u/2;z=r/2;k.width=u;k.height=r;ua.set(-w,-z,w,z);F=1;O=0;v=p=q=D=I=null};this.setClearColor=function(a,b){A=a;C=b};this.setClearColorHex=function(a,b){A.setHex(a);C=b};this.clear=function(){m.setTransform(1,0,0,-1,w,z);ka.isEmpty()||(ka.inflate(1),ka.minSelf(ua),0==A.hex&&0==C?m.clearRect(ka.getX(),ka.getY(),ka.getWidth(),ka.getHeight()):(c(THREE.NormalBlending),b(1),m.fillStyle="rgba("+Math.floor(255*A.r)+","+Math.floor(255*A.g)+","+Math.floor(255*
A.b)+","+C+")",m.fillRect(ka.getX(),ka.getY(),ka.getWidth(),ka.getHeight())),ka.empty())};this.render=function(a,h){function k(a){var b,c=a.lights;ba.setRGB(0,0,0);va.setRGB(0,0,0);wa.setRGB(0,0,0);a=0;for(b=c.length;a<b;a++){var d=c[a];var f=d.color;d instanceof THREE.AmbientLight?(ba.r+=f.r,ba.g+=f.g,ba.b+=f.b):d instanceof THREE.DirectionalLight?(va.r+=f.r,va.g+=f.g,va.b+=f.b):d instanceof THREE.PointLight&&(wa.r+=f.r,wa.g+=f.g,wa.b+=f.b)}}function r(a,b,c,d){var f,g=a.lights;a=0;for(f=g.length;a<
f;a++){var h=g[a];var k=h.color;if(h instanceof THREE.DirectionalLight){var q=c.dot(h.position);0>=q||(q*=h.intensity,d.r+=k.r*q,d.g+=k.g*q,d.b+=k.b*q)}else h instanceof THREE.PointLight&&(q=c.dot(Z.sub(h.position,b).normalize()),0>=q||(q*=0==h.distance?1:1-Math.min(b.distanceTo(h.position)/h.distance,1),0!=q&&(q*=h.intensity,d.r+=k.r*q,d.g+=k.g*q,d.b+=k.b*q)))}}function A(a,f,h,k){b(h.opacity);c(h.blending);if(h instanceof THREE.ParticleBasicMaterial){if(h.map){var q=h.map.image;var l=q.width>>1;
var p=q.height>>1;h=f.scale.x*w;var t=f.scale.y*z;k=h*l;var v=t*p;da.set(a.x-k,a.y-v,a.x+k,a.y+v);ua.instersects(da)&&(m.save(),m.translate(a.x,a.y),m.rotate(-f.rotation),m.scale(h,-t),m.translate(-l,-p),m.drawImage(q,0,0),m.restore())}}else h instanceof THREE.ParticleCanvasMaterial&&(k=f.scale.x*w,v=f.scale.y*z,da.set(a.x-k,a.y-v,a.x+k,a.y+v),ua.instersects(da)&&(d(h.color),g(h.color),m.save(),m.translate(a.x,a.y),m.rotate(-f.rotation),m.scale(k,v),h.program(m),m.restore()))}function u(a,f,g,h,k){b(h.opacity);
c(h.blending);m.beginPath();m.moveTo(a.positionScreen.x,a.positionScreen.y);m.lineTo(f.positionScreen.x,f.positionScreen.y);m.closePath();h instanceof THREE.LineBasicMaterial&&(a=h.linewidth,q!=a&&(m.lineWidth=q=a),a=h.linecap,p!=a&&(m.lineCap=p=a),a=h.linejoin,v!=a&&(m.lineJoin=v=a),d(h.color),m.stroke(),da.inflate(2*h.linewidth))}function C(a,d,g,k,q,l,m,p,t){f.data.vertices+=3;f.data.faces++;b(p.opacity);c(p.blending);M=a.positionScreen.x;H=a.positionScreen.y;T=d.positionScreen.x;W=d.positionScreen.y;
L=g.positionScreen.x;N=g.positionScreen.y;D(M,H,T,W,L,N);p instanceof THREE.MeshBasicMaterial?p.map?p.map.mapping instanceof THREE.UVMapping&&(ia=m.uvs[0],qa(M,H,T,W,L,N,p.map.image,ia[k].u,ia[k].v,ia[q].u,ia[q].v,ia[l].u,ia[l].v)):p.envMap?p.envMap.mapping instanceof THREE.SphericalReflectionMapping&&(a=h.matrixWorldInverse,Z.copy(m.vertexNormalsWorld[0]),Ia=.5*(Z.x*a.n11+Z.y*a.n12+Z.z*a.n13)+.5,Ja=.5*-(Z.x*a.n21+Z.y*a.n22+Z.z*a.n23)+.5,Z.copy(m.vertexNormalsWorld[1]),Ka=.5*(Z.x*a.n11+Z.y*a.n12+
Z.z*a.n13)+.5,La=.5*-(Z.x*a.n21+Z.y*a.n22+Z.z*a.n23)+.5,Z.copy(m.vertexNormalsWorld[2]),Ma=.5*(Z.x*a.n11+Z.y*a.n12+Z.z*a.n13)+.5,Na=.5*-(Z.x*a.n21+Z.y*a.n22+Z.z*a.n23)+.5,qa(M,H,T,W,L,N,p.envMap.image,Ia,Ja,Ka,La,Ma,Na)):p.wireframe?O(p.color,p.wireframeLinewidth,p.wireframeLinecap,p.wireframeLinejoin):ra(p.color):p instanceof THREE.MeshLambertMaterial?(p.map&&!p.wireframe&&(p.map.mapping instanceof THREE.UVMapping&&(ia=m.uvs[0],qa(M,H,T,W,L,N,p.map.image,ia[k].u,ia[k].v,ia[q].u,ia[q].v,ia[l].u,ia[l].v)),
c(THREE.SubtractiveBlending)),Fa?p.wireframe||p.shading!=THREE.SmoothShading||3!=m.vertexNormalsWorld.length?(ja.r=ba.r,ja.g=ba.g,ja.b=ba.b,r(t,m.centroidWorld,m.normalWorld,ja),R.r=Math.max(0,Math.min(p.color.r*ja.r,1)),R.g=Math.max(0,Math.min(p.color.g*ja.g,1)),R.b=Math.max(0,Math.min(p.color.b*ja.b,1)),R.updateHex(),p.wireframe?O(R,p.wireframeLinewidth,p.wireframeLinecap,p.wireframeLinejoin):ra(R)):(aa.r=U.r=K.r=ba.r,aa.g=U.g=K.g=ba.g,aa.b=U.b=K.b=ba.b,r(t,m.v1.positionWorld,m.vertexNormalsWorld[0],
aa),r(t,m.v2.positionWorld,m.vertexNormalsWorld[1],U),r(t,m.v3.positionWorld,m.vertexNormalsWorld[2],K),S.r=.5*(U.r+K.r),S.g=.5*(U.g+K.g),S.b=.5*(U.b+K.b),ha=Da(aa,U,K,S),qa(M,H,T,W,L,N,ha,0,0,1,0,0,1)):p.wireframe?O(p.color,p.wireframeLinewidth,p.wireframeLinecap,p.wireframeLinejoin):ra(p.color)):p instanceof THREE.MeshDepthMaterial?(pa=h.near,Y=h.far,aa.r=aa.g=aa.b=1-xa(a.positionScreen.z,pa,Y),U.r=U.g=U.b=1-xa(d.positionScreen.z,pa,Y),K.r=K.g=K.b=1-xa(g.positionScreen.z,pa,Y),S.r=.5*(U.r+K.r),
S.g=.5*(U.g+K.g),S.b=.5*(U.b+K.b),ha=Da(aa,U,K,S),qa(M,H,T,W,L,N,ha,0,0,1,0,0,1)):p instanceof THREE.MeshNormalMaterial&&(R.r=ya(m.normalWorld.x),R.g=ya(m.normalWorld.y),R.b=ya(m.normalWorld.z),R.updateHex(),p.wireframe?O(R,p.wireframeLinewidth,p.wireframeLinecap,p.wireframeLinejoin):ra(R))}function F(a,d,g,k,p,q,m,l,t){f.data.vertices+=4;f.data.faces++;b(l.opacity);c(l.blending);l.map||l.envMap?(C(a,d,k,0,1,3,m,l,t),C(p,g,q,1,2,3,m,l,t)):(M=a.positionScreen.x,H=a.positionScreen.y,T=d.positionScreen.x,
W=d.positionScreen.y,L=g.positionScreen.x,N=g.positionScreen.y,P=k.positionScreen.x,X=k.positionScreen.y,ea=p.positionScreen.x,la=p.positionScreen.y,fa=q.positionScreen.x,ma=q.positionScreen.y,l instanceof THREE.MeshBasicMaterial?(I(M,H,T,W,L,N,P,X),l.wireframe?O(l.color,l.wireframeLinewidth,l.wireframeLinecap,l.wireframeLinejoin):ra(l.color)):l instanceof THREE.MeshLambertMaterial?Fa?l.wireframe||l.shading!=THREE.SmoothShading||4!=m.vertexNormalsWorld.length?(ja.r=ba.r,ja.g=ba.g,ja.b=ba.b,r(t,m.centroidWorld,
m.normalWorld,ja),R.r=Math.max(0,Math.min(l.color.r*ja.r,1)),R.g=Math.max(0,Math.min(l.color.g*ja.g,1)),R.b=Math.max(0,Math.min(l.color.b*ja.b,1)),R.updateHex(),I(M,H,T,W,L,N,P,X),l.wireframe?O(R,l.wireframeLinewidth,l.wireframeLinecap,l.wireframeLinejoin):ra(R)):(aa.r=U.r=K.r=S.r=ba.r,aa.g=U.g=K.g=S.g=ba.g,aa.b=U.b=K.b=S.b=ba.b,r(t,m.v1.positionWorld,m.vertexNormalsWorld[0],aa),r(t,m.v2.positionWorld,m.vertexNormalsWorld[1],U),r(t,m.v4.positionWorld,m.vertexNormalsWorld[3],K),r(t,m.v3.positionWorld,
m.vertexNormalsWorld[2],S),ha=Da(aa,U,K,S),D(M,H,T,W,P,X),qa(M,H,T,W,P,X,ha,0,0,1,0,0,1),D(ea,la,L,N,fa,ma),qa(ea,la,L,N,fa,ma,ha,1,0,1,1,0,1)):(I(M,H,T,W,L,N,P,X),l.wireframe?O(l.color,l.wireframeLinewidth,l.wireframeLinecap,l.wireframeLinejoin):ra(l.color)):l instanceof THREE.MeshNormalMaterial?(R.r=ya(m.normalWorld.x),R.g=ya(m.normalWorld.y),R.b=ya(m.normalWorld.z),R.updateHex(),I(M,H,T,W,L,N,P,X),l.wireframe?O(R,l.wireframeLinewidth,l.wireframeLinecap,l.wireframeLinejoin):ra(R)):l instanceof THREE.MeshDepthMaterial&&
(pa=h.near,Y=h.far,aa.r=aa.g=aa.b=1-xa(a.positionScreen.z,pa,Y),U.r=U.g=U.b=1-xa(d.positionScreen.z,pa,Y),K.r=K.g=K.b=1-xa(k.positionScreen.z,pa,Y),S.r=S.g=S.b=1-xa(g.positionScreen.z,pa,Y),ha=Da(aa,U,K,S),D(M,H,T,W,P,X),qa(M,H,T,W,P,X,ha,0,0,1,0,0,1),D(ea,la,L,N,fa,ma),qa(ea,la,L,N,fa,ma,ha,1,0,1,1,0,1)))}function D(a,b,c,d,f,g){m.beginPath();m.moveTo(a,b);m.lineTo(c,d);m.lineTo(f,g);m.lineTo(a,b);m.closePath()}function I(a,b,c,d,f,g,h,l){m.beginPath();m.moveTo(a,b);m.lineTo(c,d);m.lineTo(f,g);m.lineTo(h,
l);m.lineTo(a,b);m.closePath()}function O(a,b,c,f){q!=b&&(m.lineWidth=q=b);p!=c&&(m.lineCap=p=c);v!=f&&(m.lineJoin=v=f);d(a);m.stroke();da.inflate(2*b)}function ra(a){g(a);m.fill()}function qa(a,b,c,d,f,g,h,l,k,p,q,t,v){var n=h.width-1;var fa=h.height-1;l*=n;k*=fa;c-=a;d-=b;f-=a;g-=b;p=p*n-l;q=q*fa-k;t=t*n-l;v=v*fa-k;n=p*v-t*q;0!=n&&(fa=1/n,n=(v*c-q*f)*fa,q=(v*d-q*g)*fa,c=(p*f-t*c)*fa,d=(p*g-t*d)*fa,a=a-n*l-c*k,b=b-q*l-d*k,m.save(),m.transform(n,q,c,d,a,b),m.clip(),m.drawImage(h,0,0),m.restore())}
function Da(a,b,c,d){var f=~~(255*a.r),g=~~(255*a.g);a=~~(255*a.b);var h=~~(255*b.r),l=~~(255*b.g);b=~~(255*b.b);var k=~~(255*c.r),p=~~(255*c.g);c=~~(255*c.b);var q=~~(255*d.r),m=~~(255*d.g);d=~~(255*d.b);na[0]=0>f?0:255<f?255:f;na[1]=0>g?0:255<g?255:g;na[2]=0>a?0:255<a?255:a;na[4]=0>h?0:255<h?255:h;na[5]=0>l?0:255<l?255:l;na[6]=0>b?0:255<b?255:b;na[8]=0>k?0:255<k?255:k;na[9]=0>p?0:255<p?255:p;na[10]=0>c?0:255<c?255:c;na[12]=0>q?0:255<q?255:q;na[13]=0>m?0:255<m?255:m;na[14]=0>d?0:255<d?255:d;Ba.putImageData(Oa,
0,0);Ga.drawImage(Aa,0,0);return Ca}function xa(a,b,c){a=(a-b)/(c-b);return a*a*(3-2*a)}function ya(a){a=.5*(a+1);return 0>a?0:1<a?1:a}function sa(a,b){var c=b.x-a.x,d=b.y-a.y,f=1/Math.sqrt(c*c+d*d);c*=f;d*=f;b.x+=c;b.y+=d;a.x-=c;a.y-=d}var Pa,ta,Ea;this.autoClear?this.clear():m.setTransform(1,0,0,-1,w,z);f.data.vertices=0;f.data.faces=0;l=n.projectScene(a,h,this.sortElements);(Fa=0<a.lights.length)&&k(a);var Ha=0;for(Pa=l.length;Ha<Pa;Ha++){var V=l[Ha];da.empty();if(V instanceof THREE.RenderableParticle){t=
V;t.x*=w;t.y*=z;var oa=0;for(ta=V.materials.length;oa<ta;){var ca=V.materials[oa++];0!=ca.opacity&&A(t,V,ca,a)}}else if(V instanceof THREE.RenderableLine){if(t=V.v1,G=V.v2,t.positionScreen.x*=w,t.positionScreen.y*=z,G.positionScreen.x*=w,G.positionScreen.y*=z,da.addPoint(t.positionScreen.x,t.positionScreen.y),da.addPoint(G.positionScreen.x,G.positionScreen.y),ua.instersects(da))for(oa=0,ta=V.materials.length;oa<ta;)ca=V.materials[oa++],0!=ca.opacity&&u(t,G,V,ca,a)}else if(V instanceof THREE.RenderableFace3){if(t=
V.v1,G=V.v2,B=V.v3,t.positionScreen.x*=w,t.positionScreen.y*=z,G.positionScreen.x*=w,G.positionScreen.y*=z,B.positionScreen.x*=w,B.positionScreen.y*=z,V.overdraw&&(sa(t.positionScreen,G.positionScreen),sa(G.positionScreen,B.positionScreen),sa(B.positionScreen,t.positionScreen)),da.add3Points(t.positionScreen.x,t.positionScreen.y,G.positionScreen.x,G.positionScreen.y,B.positionScreen.x,B.positionScreen.y),ua.instersects(da))for(oa=0,ta=V.meshMaterials.length;oa<ta;)if(ca=V.meshMaterials[oa++],ca instanceof
THREE.MeshFaceMaterial){var za=0;for(Ea=V.faceMaterials.length;za<Ea;)(ca=V.faceMaterials[za++])&&0!=ca.opacity&&C(t,G,B,0,1,2,V,ca,a)}else 0!=ca.opacity&&C(t,G,B,0,1,2,V,ca,a)}else if(V instanceof THREE.RenderableFace4&&(t=V.v1,G=V.v2,B=V.v3,J=V.v4,t.positionScreen.x*=w,t.positionScreen.y*=z,G.positionScreen.x*=w,G.positionScreen.y*=z,B.positionScreen.x*=w,B.positionScreen.y*=z,J.positionScreen.x*=w,J.positionScreen.y*=z,E.positionScreen.copy(G.positionScreen),Q.positionScreen.copy(J.positionScreen),
V.overdraw&&(sa(t.positionScreen,G.positionScreen),sa(G.positionScreen,J.positionScreen),sa(J.positionScreen,t.positionScreen),sa(B.positionScreen,E.positionScreen),sa(B.positionScreen,Q.positionScreen)),da.addPoint(t.positionScreen.x,t.positionScreen.y),da.addPoint(G.positionScreen.x,G.positionScreen.y),da.addPoint(B.positionScreen.x,B.positionScreen.y),da.addPoint(J.positionScreen.x,J.positionScreen.y),ua.instersects(da)))for(oa=0,ta=V.meshMaterials.length;oa<ta;)if(ca=V.meshMaterials[oa++],ca instanceof
THREE.MeshFaceMaterial)for(za=0,Ea=V.faceMaterials.length;za<Ea;)(ca=V.faceMaterials[za++])&&0!=ca.opacity&&F(t,G,B,J,E,Q,V,ca,a);else 0!=ca.opacity&&F(t,G,B,J,E,Q,V,ca,a);ka.addRectangle(da)}m.setTransform(1,0,0,1,0,0)}};THREE.RenderableVertex=function(){this.positionWorld=new THREE.Vector3;this.positionScreen=new THREE.Vector4;this.visible=!0};THREE.RenderableVertex.prototype.copy=function(a){this.positionWorld.copy(a.positionWorld);this.positionScreen.copy(a.positionScreen)};
THREE.RenderableFace3=function(){this.v1=new THREE.RenderableVertex;this.v2=new THREE.RenderableVertex;this.v3=new THREE.RenderableVertex;this.centroidWorld=new THREE.Vector3;this.centroidScreen=new THREE.Vector3;this.normalWorld=new THREE.Vector3;this.vertexNormalsWorld=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3];this.faceMaterials=this.meshMaterials=null;this.overdraw=!1;this.uvs=[[]];this.z=null};
THREE.RenderableFace4=function(){this.v1=new THREE.RenderableVertex;this.v2=new THREE.RenderableVertex;this.v3=new THREE.RenderableVertex;this.v4=new THREE.RenderableVertex;this.centroidWorld=new THREE.Vector3;this.centroidScreen=new THREE.Vector3;this.normalWorld=new THREE.Vector3;this.vertexNormalsWorld=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3];this.faceMaterials=this.meshMaterials=null;this.overdraw=!1;this.uvs=[[]];this.z=null};
THREE.RenderableObject=function(){this.z=this.object=null};THREE.RenderableParticle=function(){this.rotation=this.z=this.y=this.x=null;this.scale=new THREE.Vector2;this.materials=null};THREE.RenderableLine=function(){this.z=null;this.v1=new THREE.RenderableVertex;this.v2=new THREE.RenderableVertex;this.materials=null};
THREE.Plane=function(a,b,c,d){THREE.Geometry.call(this);var g,h=a/2,f=b/2;c=c||1;d=d||1;var l=c+1,n=d+1;a/=c;var k=b/d;for(g=0;g<n;g++)for(b=0;b<l;b++)this.vertices.push(new THREE.Vertex(new THREE.Vector3(b*a-h,-(g*k-f),0)));for(g=0;g<d;g++)for(b=0;b<c;b++)this.faces.push(new THREE.Face4(b+l*g,b+l*(g+1),b+1+l*(g+1),b+1+l*g)),this.faceVertexUvs[0].push([new THREE.UV(b/c,g/d),new THREE.UV(b/c,(g+1)/d),new THREE.UV((b+1)/c,(g+1)/d),new THREE.UV((b+1)/c,g/d)]);this.computeCentroids();this.computeFaceNormals()};
THREE.Plane.prototype=new THREE.Geometry;THREE.Plane.prototype.constructor=THREE.Plane;var cancelRequestAnimFrame=function(){return window.cancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||clearTimeout}();THREE.Ploy=function(a){THREE.Geometry.call(this);for(var b=0;b<a.length;b++)this.vertices.push(new THREE.Vertex(new THREE.Vector3(a[b][0],a[b][1],0)));4==a.length?this.faces.push(new THREE.Face4(0,1,2,3)):this.faces.push(new THREE.Face3(0,1,2));this.computeCentroids();this.computeFaceNormals()};THREE.Ploy.prototype=new THREE.Geometry;THREE.Ploy.prototype.constructor=THREE.Ploy;
window.twistyjs=function(){var a={},b={};a.registerTwisty=function(a,d){b[a]=d};a.TwistyScene=function(){function a(a){e.preventDefault&&e.preventDefault();v.addEventListener("mousemove",d,!1);v.addEventListener("mouseup",g,!1);v.addEventListener("mouseout",h,!1);B=a.clientX}function d(a){G=a.clientX;z.cam((B-G)/256);B=G}function g(a){v.removeEventListener("mousemove",d,!1);v.removeEventListener("mouseup",g,!1);v.removeEventListener("mouseout",h,!1)}function h(a){v.removeEventListener("mousemove",
d,!1);v.removeEventListener("mouseup",g,!1);v.removeEventListener("mouseout",h,!1)}function f(a){1==a.touches.length&&(a.preventDefault&&a.preventDefault(),B=a.touches[0].pageX)}function l(a){1==a.touches.length&&(a.preventDefault&&a.preventDefault(),G=a.touches[0].pageX,z.cam((B-G)/256),B=G)}function n(){D.render(I,O)}function k(a){p=a;O.position=new THREE.Vector3(2*Math.sin(a),2,2*Math.cos(a))}function u(a){for(var b=0;b<J.length;b++)J[b](a,0)}function r(){C.push(F.shift());A.push(0);M.push($.now());
for(var a=C[C.length-1],b=0;b<J.length;b++)J[b](a,1)}function w(a){a=$.now();var b=(a-H)/(kernel.getProp("vrcSpeed",100)||.001)*(F.length+2)/2;H=a;a=Math.max(Math.min(b,1),1E-4);for(b=0;b<A.length;b++)A[b]+=a;if(1>A[0])for(b=0;b<C.length;b++)m.animateMoveCallback(m,C[b],A[b],a);else{E.push(C.shift());M.shift();A.shift();if(0==C.length)for(;0!=E.length;)for(m.advanceMoveCallback(m,E[0]),a=E.shift(),b=0;b<J.length;b++)J[b](a,2);0==F.length&&0==C.length?null!==Q&&(cancelRequestAnimFrame(Q),Q=null):0==
C.length&&r()}n();null!==Q&&(Q=requestAnimFrame(w,q))}var z=this,m=null,A=null,C=null,F=[],O,I,D,q,p=0,v=$("<div/>");v.css("width","100%");v.css("height","100%");v=v[0];this.getDomElement=function(){return v};this.getCanvas=function(){return q};this.getTwisty=function(){return m};this.initializeTwisty=function(c){F=[];C=[];A=[];null!==Q&&(cancelRequestAnimFrame(Q),Q=null);$(v).empty();I=new THREE.Scene;var d=b[c.type];m=d?d(z,c):null;I.addObject(m._3d);D=new THREE.CanvasRenderer;q=D.domElement;v.appendChild(q);
c.allowDragging&&($(v).css("cursor","move"),v.addEventListener("mousedown",a,!1),v.addEventListener("touchstart",f,!1),v.addEventListener("touchmove",l,!1));z.resize()};this.resize=function(){var a=Math.min($(v).width(),$(v).height());O=new THREE.Camera(30,1,0,1E3);k(0);O.target.position=new THREE.Vector3(0,-.075,0);D.setSize(a,a);n()};this.keydown=function(a){var b=a.keyCode,c=m.keydownCallback(m,a);switch(b){case 37:p+=Math.TAU/48;k(p);n();a.preventDefault&&a.preventDefault();break;case 39:p+=-Math.TAU/
48;k(p);n();a.preventDefault&&a.preventDefault();break;default:c&&n()}};var t=0,G=0,B=0;this.cam=function(a){t+=a;k(t);n()};var J=[];this.addMoveListener=function(a){J.push(a)};this.removeMoveListener=function(a){a=J.indexOf(a);delete J[a]};this.addMoves=function(a){$.map(a,u);kernel.getProp("vrcSpeed",100)?(F=F.concat(a),0<F.length&&(null===Q?(r(),H=$.now(),Q=requestAnimFrame(w,q)):m.isParallelMove(m,C[0],F[0])&&r())):this.applyMoves(a)};this.isMoveFinished=function(){return 0==F.length&&0==C.length&&
0==E.length};this.isAnimationFinished=function(){return 0==C.length};this.applyMoves=function(a){for(F=F.concat(a);0<F.length;)r(),m.advanceMoveCallback(m,C.shift()),M.shift(),A.shift();n()};var E=[],Q=null,M=[],H=0};return a}();(function(){function a(a,b,c){var d=new THREE.Matrix4;d.set(a.x,b.x,c.x,0,a.y,b.y,c.y,0,a.z,b.z,c.z,0,0,0,0,1);return d}function b(a,b){return a.n14*b.x+a.n24*b.y+a.n34*b.z}twistyjs.registerTwisty("cube",function(d,f){function g(b,c,d,f){for(var g=0;g<b.length;g++){var h=b[g],l=g+1&2?d:f,k=g&1?1:-1,p=g&2?1:-1,q=Math.sqrt(2)/2;h.matrix.copy((new THREE.Matrix4).multiply(a(new THREE.Vector3(1*p,0,0),new THREE.Vector3(0,q*p,-q*p),new THREE.Vector3(0,q,q)),(new THREE.Matrix4).setTranslation(k*(c-2*l),
c*(2*q+.05),0)));h.update()}}function h(a){a=a.options.dimension;for(var b=[],c=0;32>c;c++){var d=1+~~(Math.random()*a/2);b.push([d,d+~~(Math.random()*a/2),"ULFRBD".split("")[~~(6*Math.random())],[-2,-1,1,2][~~(4*Math.random())]])}return b}function l(a,b,c){return{73:[1,b,"R",1],75:[1,b,"R",-1],87:[1,1,"B",1],79:[1,1,"B",-1],83:[1,1,"D",1],76:[1,1,"D",-1],68:[1,a,"L",1],69:[1,a,"L",-1],74:[1,1,"U",1],70:[1,1,"U",-1],72:[1,1,"F",1],71:[1,1,"F",-1],186:[1,c,"U",1],59:[1,c,"U",1],65:[1,c,"U",-1],85:[1,
b+1,"R",1],82:[1,a+1,"L",-1],77:[1,b+1,"R",-1],86:[1,a+1,"L",1],84:[1,c,"L",-1],89:[1,c,"R",1],78:[1,c,"R",-1],66:[1,c,"L",1],190:[b+1,b+1,"R",1],88:[a+1,a+1,"L",-1],53:[a+1,a+1,"L",1],54:[b+1,b+1,"R",-1],80:[1,c,"F",1],81:[1,c,"F",-1],90:[1,2,"D",1],67:[1,2,"U",-1],188:[1,2,"U",1],191:[1,2,"D",-1]}}function m(a){a=a||this;var d=[],f=a.cubePieces;a=a.options.dimension;for(var g=[1,0,0,1,0,0],h=[1,-1,-1,-1,-1,-1],l=[1,-1,1,1,1,-1],p=0;p<c;p++)for(var q=f[p],m=0;m<q.length;m++){var t=q[m],v=[];v.push(Math.round(b(t[0],
r.U)));v.push(Math.round(b(t[0],r.R)));v.push(Math.round(b(t[0],r.F)));var n=v.indexOf(a)+v.indexOf(-a)+1;t=(a-v[n])/2+n;v.splice(n,1);n=g[t];x=(v[n]*h[t]+a-1)/2;y=(v[1-n]*l[t]+a-1)/2;d[t*a*a+x*a+y]=k[p]}return d.join("")}function n(a,b){return 1==b[0]&&b[1]==a.options.dimension}var q=new THREE.Object3D,p=[],v={stickerBorder:!0,stickerWidth:1.8,doubleSided:!0,opacity:1,dimension:3,faceColors:[16777215,16711680,65280,16776960,16748544,255],scale:1};for(G in v)G in f&&(v[G]=f[G]);var t={};var G=new THREE.MeshBasicMaterial({color:0,
wireframe:!0,wireframeLinewidth:1,opacity:v.opacity});for(var B=0;B<c;B++)t[B]=new THREE.MeshBasicMaterial({color:v.faceColors[B],opacity:v.opacity});for(B=0;B<c;B++){var A=[];p.push(A);for(var E=0;E<v.dimension;E++)for(var Q=0;Q<v.dimension;Q++){var M=new THREE.Object3D,H=B;if(7<v.dimension){var T=Math.min(E,v.dimension-1-E),W=Math.min(Q,v.dimension-1-Q);H+=","+(T+W)+","+T*W}t[H]=t[H]||new THREE.MeshBasicMaterial({color:v.faceColors[B],opacity:v.opacity});H=[t[H]];v.stickerBorder&&H.push(G);H=new THREE.Mesh(new THREE.Plane(v.stickerWidth,
v.stickerWidth),H);H.doubleSided=v.doubleSided;M.addChild(H);H=(new THREE.Matrix4).multiply(z[B],(new THREE.Matrix4).setTranslation(2*E-v.dimension+1,-(2*Q-v.dimension+1),v.dimension));M.matrix.copy(H);M.matrixAutoUpdate=!1;M.update();A.push([H,M]);q.addChild(M)}}A=[];if(5<v.dimension)for(E=v.dimension/15,B=0;4>B;B++)M=new THREE.Object3D,H=new THREE.Mesh(new THREE.Ploy([[0,0],[E/2,E],[-E/2,E]]),[B+1&2?t[4]:t[1],G]),H.doubleSided=v.doubleSided,M.addChild(H),M.matrixAutoUpdate=!1,A.push(M),q.addChild(M);
t=.5*v.scale/v.dimension;q.scale=new THREE.Vector3(t,t,t);var L=1,N=1,P=v.dimension,X=l(L,N,P);g(A,P,L,N);var ea=0,la=-1;return{type:f,options:v,_3d:q,cubePieces:p,handMarks:A,animateMoveCallback:function(a,d,f,g){f=new THREE.Matrix4;f.setRotationAxis(w[d[2]],g*d[3]*Math.TAU/4);g=a.cubePieces;var h=d[0],l=d[1];0>l&&(l=a.options.dimension+1+l);h=a.options.dimension-2*h+2.5;a=a.options.dimension-2*l-.5;d=r[d[2]];for(l=0;l<c;l++)for(var p=g[l],q=0,k=p.length;q<k;q++){var m=p[q],t=b(m[1].matrix,d);t<
h&&t>a&&(m[1].matrix.multiply(f,m[1].matrix),m[1].update())}},advanceMoveCallback:function(a,d){n(a,d)||d[2]==la||ea++;la=d[2];var f=u[d[2]],g=d[3];if(0>g){var h=new THREE.Matrix4;h=THREE.Matrix4.makeInvert(f,h)}else h=f.clone();f=new THREE.Matrix4;for(var l=0;l<Math.abs(g);l++)f.multiplySelf(h);g=a.cubePieces;h=a.options.dimension-2*d[0]+2.5;l=a.options.dimension-2*d[1]-.5;for(var p=r[d[2]],q=0;q<c;q++)for(var k=g[q],m=0,t=k.length;m<t;m++){var v=k[m],B=b(v[1].matrix,p);B<h&&B>l&&(v[0].multiply(f,
v[0]),v[1].matrix.copy(v[0]),v[1].update())}},toggleColorVisible:function(a,b){if(a.visible!=b)for(var d=a.cubePieces,f=0;f<c;f++)for(var g=d[f],h=0,l=g.length;h<l;h++)g[h][1].children[0].materials[0].opacity=b?1:0},keydownCallback:function(a,b){if(!b.altKey&&!b.ctrlKey){var f=b.keyCode,h=!1;if(51==f||52==f||55==f||56==f||32==f){51==f?L=Math.max(1,L-1):52==f?L=Math.min(L+1,P-1):55==f?N=Math.min(N+1,P-1):56==f?N=Math.max(1,N-1):32==f&&(L=N=1);X=l(L,N,P);g(a.handMarks,P,L,N);if(7<a.options.dimension){h=
"0"==kernel.getProp("vrcAH","01")[0]?!1:!0;var p="0"==kernel.getProp("vrcAH","01")[1]?!1:!0,q=a.options.dimension,k=a.cubePieces,m={0:0,1:0};m[L-1]=0;m[L+0]=0;m[L+1]=0;m[N-1]=0;m[N+0]=0;for(var t=m[N+1]=0;t<c;t++)for(var v=k[t],n=0,B=v.length;n<B;n++){var r=n%q,u=~~(n/q),A=v[n][1].children[0].materials;r=r in m||q-1-r in m||u in m||q-1-u in m;A[0].opacity=r||h?1:0;r||p?A[1]=a.borderMaterial:A.length=1}}h=!0}f in X&&d.addMoves([X[f]]);return h}},isSolved:function(a){if(!d.isAnimationFinished())return 99;
if(3==a.options.dimension){var f=cubeutil.getProgress(m(a),kernel.getProp("vrcMP","n"));return d.isMoveFinished()?f:Math.max(1,f)}if(!d.isMoveFinished())return 1;f=a.cubePieces;a=a.options.dimension;for(var g=0;g<c-1;g++){for(var h,l=f[g],q=0;q<c&&!(.5>Math.abs(b(l[0][0],h=r[k[q]])-a));q++);q=1;for(var p=l.length;q<p;q++)if(.5<Math.abs(b(l[q][0],h)-a))return 1}return 0},isInspectionLegalMove:n,isParallelMove:function(a,b,c){return"URFDLB".indexOf(b[2])%3=="URFDLB".indexOf(c[2])%3},generateScramble:h,
parseScramble:function(a){if(a.match(/^\s*$/))return h(this);var b=kernel.parseScramble(a,"URFDLB");a=[];for(var c=0;c<b.length;c++)0<b[c][1]?a.push([1,b[c][1],"URFDLB".charAt(b[c][0]),[1,2,-1][b[c][2]-1]]):a.push([1,3,"URFDLB".charAt(b[c][0]),[1,2,-1][-b[c][2]-1]]);return a},getFacelet:m,moveCnt:function(a){a&&(ea=0,la=-1);return ea},borderMaterial:G,move2str:function(a){var b=a[2],c=a[1],d=(a[3]+3)%4;return c==P?"yxz".charAt("URFDLB".indexOf(a[2])%3)+" 2'".charAt(-1=="URF".indexOf(a[2])?2-d:d):
2==a[0]?"2-2"+a[2]+"w"+" 2'".charAt(d):(2<c?c:"")+b+(2<=c?"w":"")+" 2'".charAt(d)}}});var c=6,d=new THREE.Vector3(1,0,0),g=new THREE.Vector3(0,1,0),h=new THREE.Vector3(0,0,1),f=new THREE.Vector3(-1,0,0),l=new THREE.Vector3(0,-1,0),n=new THREE.Vector3(0,0,-1),k="URFDLB".split(""),u={U:a(h,g,f),L:a(d,h,l),F:a(l,d,h),R:a(d,n,g),B:a(g,f,h),D:a(n,g,d)},r={U:g,L:f,F:h,R:d,B:n,D:l},w={U:l,L:d,F:n,R:f,B:h,D:g},z=[a(d,n,g),a(n,g,d),a(d,g,h),a(d,h,l),a(h,g,f),a(f,g,n)]})();(function(){function a(a,b,c){var d=new THREE.Matrix4;d.set(a.x,b.x,c.x,0,a.y,b.y,c.y,0,a.z,b.z,c.z,0,0,0,0,1);return d}function b(a,b){return a.n14*b.x+a.n24*b.y+a.n34*b.z}twistyjs.registerTwisty("sq1",function(a,c){function f(a){var c=P[0];a=a.cubePieces;for(var d=0;d<A;d++)for(var f=a[d],g=0,h=f.length;g<h;g++){var l=b(f[g][1].matrix,c);if(.01>Math.abs(l))return!1}return!0}function g(a,b){return-5==b[2]&&5==b[3]}var h=new THREE.Object3D,l=[],q={stickerBorder:!0,stickerWidth:1.8,doubleSided:!0,
opacity:1,dimension:3,faceColors:[16776960,255,16711680,65280,16746496,16777215],scale:1};for(k in q)k in c&&(q[k]=c[k]);var k=[];for(var n=new THREE.MeshBasicMaterial({color:0,wireframe:!0,wireframeLinewidth:1,opacity:q.opacity}),r=0;r<A;r++)k.push(new THREE.MeshBasicMaterial({color:q.faceColors[r],opacity:q.opacity}));for(r=0;r<A;r++){var u=[];l.push(u);for(var w=0;w<m[r].length;w++){curf=m[r][w];var z=new THREE.Object3D,D=[k[r]];q.stickerBorder&&D.push(n);for(var L=[],N=0;N<curf[0].length;N++)L[N]=
[curf[0][N][0]*d,curf[0][N][1]*d];D=new THREE.Mesh(new THREE.Ploy(L),D);D.doubleSided=q.doubleSided;z.addChild(D);D=(new THREE.Matrix4).setRotationAxis(O[C[r]],Math.TAU/4*curf[4]).multiplySelf(I[r]).multiplySelf((new THREE.Matrix4).setTranslation(curf[1]*d,curf[2]*d,curf[3]*d));z.matrix.copy(D);z.matrixAutoUpdate=!1;z.update();u.push([D,z]);h.addChild(z)}}k=.5*q.scale/q.dimension;h.scale=new THREE.Vector3(k,k,k);var P=[new THREE.Vector3(Math.cos(Math.TAU/24),0,Math.sin(Math.TAU/24)),F[C[0]],F[C[5]],
new THREE.Vector3(Math.sin(Math.TAU/24),0,-Math.cos(Math.TAU/24))],X={73:[0,6,0,5],75:[0,-6,0,5],83:[2,1,1,5],76:[2,-1,1,5],74:[1,1,1,5],70:[1,-1,1,5],186:[1,6,-5,5],59:[1,6,-5,5],65:[1,-6,-5,5],84:[0,6,-5,5],89:[0,6,-5,5],78:[0,-6,-5,5],66:[0,-6,-5,5],80:[3,-6,-5,5],81:[3,6,-5,5]},ea=0,la=-1;return{type:c,options:q,_3d:h,cubePieces:l,animateMoveCallback:function(a,c,d,g){if(f(a)||0!=c[0]||0!=c[2]){d=new THREE.Matrix4;var h=P[c[0]];d.setRotationAxis(h,Math.TAU/12*-g*c[1]);a=a.cubePieces;for(g=0;g<
A;g++)for(var l=a[g],q=0,k=l.length;q<k;q++){var p=l[q],m=b(p[1].matrix,h);m>c[2]&&m<c[3]&&(p[1].matrix.multiply(d,p[1].matrix),p[1].update())}}},advanceMoveCallback:function(a,c){if(f(a)||0!=c[0]||0!=c[2]){g(a,c)||c[0]==la||ea++;la=c[0];var d=new THREE.Matrix4,h=P[c[0]];d.setRotationAxis(h,-(Math.TAU/12*c[1]));for(var l=a.cubePieces,q=0;q<A;q++)for(var k=l[q],p=0,m=k.length;p<m;p++){var t=k[p],v=b(t[1].matrix,h);v>c[2]&&v<c[3]&&(t[0].multiply(d,t[0]),t[1].matrix.copy(t[0]),t[1].update())}}},keydownCallback:function(b,
c){if(!c.altKey&&!c.ctrlKey){var d=c.keyCode;d in X&&a.addMoves([X[d]])}},isSolved:function(c){if(!a.isMoveFinished())return 1;c=c.cubePieces;for(var d=0;d<A-1;d++)for(var f=c[d],g=new THREE.Vector3(f[0][0].n13,f[0][0].n23,f[0][0].n33),h=b(f[0][0],g),l=1,q=f.length;l<q;l++)if(.1<Math.abs(b(f[l][0],g)-h))return 1;return 0},isInspectionLegalMove:g,isParallelMove:function(a,b,c){return b[0]==c[0]||2==b[0]*c[0]?!0:!1},generateScramble:function(a){a=a.options.dimension;for(var b=[],c=0;32>c;c++){var d=
1+~~(Math.random()*a/2);b.push([d,d+~~(Math.random()*a/2),"ULFRBD".split("")[~~(6*Math.random())],[-2,-1,1,2][~~(4*Math.random())]])}return b},parseScramble:function(a){a=a.split("/");var b=/\s*\((-?\d+), *(-?\d+)\)\s*/;ret=[];for(var c=0;c<a.length;c++){var d=b.exec(a[c]);if(d){var f=~~d[1];d=~~d[2];0!=f&&ret.push([1,f,1,5]);0!=d&&ret.push([2,d,1,5])}c!=a.length-1&&ret.push([0,6,0,5])}return ret},moveCnt:function(a){a&&(ea=0);return ea},move2str:function(a){var b=a[0],c=a[1];a=a[3]-a[2];if(4==a)return 1==
b?"("+c+",0)":"(0,"+c+")";if(5==a)return 6==c?"/":"/'";if(10==a)return"y"+(6==c?"":"'")+"2"}}});var c=Math.sqrt(3)/2,d=1.5,g=1+c,h=(Math.sqrt(2)+Math.sqrt(6))/2,f=(3+Math.sqrt(3))/4,l=h-1.2,n=[[0,.9],[-.45,-c+.05*c],[.45,-c+.05*c]],k=[[.9,.9],[.45,-c+.05*c],[-c+.05*c,-c+.05*c],[-c+.05*c,.45]],u=[[-.45,.6-.05],[-.45,-.6+.05],[.45,-.6+.05],[.45,.6-.05]],r=[[-(.5+c)/2+.05,.6-.05],[-(.5+c)/2+.05,-.6+.05],[(.5+c)/2-.05,-.6+.05],[(.5+c)/2-.05,.6-.05]],w=[[-g+.05,l-.05],[-g+.05,-l+.05],[g-.05,-l+.05],[g-
.05,l-.05]],z=[[-(1.5+c)/2+.05,l-.05],[-(1.5+c)/2+.05,-l+.05],[(1.5+c)/2-.05,-l+.05],[(1.5+c)/2-.05,l-.05]];c=[[-(.5+c)/2+.05,l-.05],[-(.5+c)/2+.05,-l+.05],[(.5+c)/2-.05,-l+.05],[(.5+c)/2-.05,l-.05]];var m=[[[n,0,-1,h,0],[k,-1,-1,h,0],[n,0,-1,h,1],[k,-1,-1,h,1],[n,0,-1,h,2],[k,-1,-1,h,2],[n,0,-1,h,3],[k,-1,-1,h,3]],[[u,0,h-.6,g,0],[r,f,h-.6,g,0],[r,-f,h-.6,g,0],[u,0,h-.6,g,2],[r,f,h-.6,g,2],[r,-f,h-.6,g,2],[w,0,0,g,0]],[[u,0,h-.6,g,0],[r,f,h-.6,g,0],[r,-f,h-.6,g,0],[u,0,h-.6,g,2],[r,f,h-.6,g,2],[r,
-f,h-.6,g,2],[z,f-.5,0,g,0],[c,-f,0,g,0]],[[u,0,h-.6,g,0],[r,f,h-.6,g,0],[r,-f,h-.6,g,0],[u,0,h-.6,g,2],[r,f,h-.6,g,2],[r,-f,h-.6,g,2],[w,0,0,g,0]],[[u,0,h-.6,g,0],[r,f,h-.6,g,0],[r,-f,h-.6,g,0],[u,0,h-.6,g,2],[r,f,h-.6,g,2],[r,-f,h-.6,g,2],[z,f-.5,0,g,0],[c,-f,0,g,0]],[[n,0,-1,h,0],[k,-1,-1,h,0],[n,0,-1,h,1],[k,-1,-1,h,1],[n,0,-1,h,2],[k,-1,-1,h,2],[n,0,-1,h,3],[k,-1,-1,h,3]]],A=6;g=new THREE.Vector3(1,0,0);h=new THREE.Vector3(0,1,0);f=new THREE.Vector3(0,0,1);n=new THREE.Vector3(-1,0,0);k=new THREE.Vector3(0,
-1,0);u=new THREE.Vector3(0,0,-1);var C="ULFRBD".split("");a(f,h,n);a(g,f,k);a(k,g,f);a(g,u,h);a(h,n,f);a(u,h,g);var F={U:h,L:n,F:f,R:g,B:u,D:k},O={U:k,L:g,F:u,R:n,B:f,D:h},I=[a(g,u,h),a(f,h,n),a(g,h,f),a(u,h,g),a(n,h,u),a(g,f,k)]})();(function(){function a(a,b,c){var d=new THREE.Matrix4;d.set(a.x,b.x,c.x,0,a.y,b.y,c.y,0,a.z,b.z,c.z,0,0,0,0,1);return d}function b(a,b){return a.n14*b.x+a.n24*b.y+a.n34*b.z}twistyjs.registerTwisty("skewb",function(a,d){function k(a){a=a.options.dimension;for(var b=[],c=0;32>c;c++){var d=1+~~(Math.random()*a/2);b.push([d,d+~~(Math.random()*a/2),"ULFRBD".split("")[~~(6*Math.random())],[-2,-1,1,2][~~(4*Math.random())]])}return b}function m(a,b){return 4<=b[0]&&6>=b[0]}var n=new THREE.Object3D,A=[],D=
{stickerBorder:!0,stickerWidth:1.8,doubleSided:!0,opacity:1,dimension:3,faceColors:[16777215,16746496,65280,16711680,255,16776960],scale:1};for(q in D)q in d&&(D[q]=d[q]);var q=[];for(var p=new THREE.MeshBasicMaterial({color:0,wireframe:!0,wireframeLinewidth:1,opacity:D.opacity}),v=0;v<h;v++)q.push(new THREE.MeshBasicMaterial({color:D.faceColors[v],opacity:D.opacity}));for(v=0;v<h;v++){var t=[];A.push(t);for(var G=0;G<g.length;G++){curf=g[G];var B=new THREE.Object3D,J=[q[v]];D.stickerBorder&&J.push(p);
for(var E=[],Q=0;Q<curf[0].length;Q++)E[Q]=[curf[0][Q][0]*c,curf[0][Q][1]*c];J=new THREE.Mesh(new THREE.Ploy(E),J);J.doubleSided=D.doubleSided;B.addChild(J);J=(new THREE.Matrix4).setRotationAxis(w[r[v]],Math.TAU/4*curf[4]).multiplySelf(z[v]).multiplySelf((new THREE.Matrix4).setTranslation(curf[1]*c,curf[2]*c,curf[3]*c));B.matrix.copy(J);B.matrixAutoUpdate=!1;B.update();t.push([J,B]);n.addChild(B)}}q=.5*D.scale/D.dimension;n.scale=new THREE.Vector3(q,q,q);var M=[new THREE.Vector3(0,Math.sqrt(1/3),
-Math.sqrt(2/3)),new THREE.Vector3(Math.sqrt(2/3),-Math.sqrt(1/3),0),new THREE.Vector3(-Math.sqrt(2/3),-Math.sqrt(1/3),0),new THREE.Vector3(0,-Math.sqrt(1/3),-Math.sqrt(2/3)),f,l,u,new THREE.Vector3(Math.sqrt(2/3),Math.sqrt(1/3),0),new THREE.Vector3(-Math.sqrt(2/3),Math.sqrt(1/3),0),new THREE.Vector3(0,Math.sqrt(1/3),Math.sqrt(2/3)),new THREE.Vector3(0,-Math.sqrt(1/3),Math.sqrt(2/3))],H={73:[7,4,0,5],75:[7,-4,0,5],87:[3,4,0,5],79:[3,-4,0,5],83:[10,4,0,5],76:[10,-4,0,5],68:[8,4,0,5],69:[8,-4,0,5],
74:[0,4,0,5],70:[0,-4,0,5],72:[9,4,0,5],71:[9,-4,0,5],186:[5,3,-5,5],59:[5,3,-5,5],65:[5,-3,-5,5],84:[4,3,-5,5],89:[4,3,-5,5],78:[4,-3,-5,5],66:[4,-3,-5,5],80:[6,-3,-5,5],81:[6,3,-5,5]},T=0,W=-1;return{type:d,options:D,_3d:n,cubePieces:A,animateMoveCallback:function(a,c,d,f){d=new THREE.Matrix4;var g=M[c[0]];d.setRotationAxis(g,Math.TAU/12*-f*c[1]);a=a.cubePieces;for(f=0;f<h;f++)for(var l=a[f],q=0,k=l.length;q<k;q++){var p=l[q],m=b(p[1].matrix,g);m>c[2]&&m<c[3]&&(p[1].matrix.multiply(d,p[1].matrix),
p[1].update())}},advanceMoveCallback:function(a,c){m(a,c)||c[0]==W||T++;W=c[0];var d=new THREE.Matrix4,f=M[c[0]];d.setRotationAxis(f,-(Math.TAU/12*c[1]));for(var g=a.cubePieces,l=0;l<h;l++)for(var q=g[l],k=0,p=q.length;k<p;k++){var t=q[k],v=b(t[1].matrix,f);v>c[2]&&v<c[3]&&(t[0].multiply(d,t[0]),t[1].matrix.copy(t[0]),t[1].update())}},keydownCallback:function(b,c){if(!c.altKey&&!c.ctrlKey){var d=c.keyCode;d in H&&a.addMoves([H[d]])}},isSolved:function(c){if(!a.isMoveFinished())return 1;c=c.cubePieces;
for(var d=0;d<h-1;d++)for(var f=c[d],g=new THREE.Vector3(f[0][0].n13,f[0][0].n23,f[0][0].n33),l=b(f[0][0],g),q=1,k=f.length;q<k;q++)if(.1<Math.abs(b(f[q][0],g)-l))return 1;return 0},isInspectionLegalMove:m,isParallelMove:function(a,b,c){return b[0]==c[0]},generateScramble:k,parseScramble:function(a){if(a.match(/^\s*$/))return k(this);var b=kernel.parseScramble(a,"URLB");a=[];for(var c=0;c<b.length;c++)a.push([b[c][0],[4,0,-4][b[c][2]-1],0,5]);return a},moveCnt:function(a){a&&(T=0,W=-1);return T},
move2str:function(a){var b=a[1];return"U??BxyzRLFD".charAt(a[0])+(0<b?"":"'")}}});var c=1.4,d=[[-.4,-.4],[1.4,-.4],[-.4,1.4]],g=[[d,-1.5,-1.5,2,0],[d,-1.5,-1.5,2,1],[d,-1.5,-1.5,2,2],[d,-1.5,-1.5,2,3],[[[1.8,0],[0,1.8],[-1.8,0],[0,-1.8]],0,0,2,0]],h=6,f=new THREE.Vector3(Math.sqrt(2)/2,0,Math.sqrt(2)/2),l=new THREE.Vector3(0,1,0);d=new THREE.Vector3(-Math.sqrt(2)/2,0,Math.sqrt(2)/2);var n=new THREE.Vector3(-Math.sqrt(2)/2,0,-Math.sqrt(2)/2),k=new THREE.Vector3(0,-1,0),u=new THREE.Vector3(Math.sqrt(2)/
2,0,-Math.sqrt(2)/2),r="ULFRBD".split("");a(d,l,n);a(f,d,k);a(k,f,d);a(f,u,l);a(l,n,d);a(u,l,f);var w={U:k,L:f,F:u,R:n,B:d,D:l},z=[a(f,u,l),a(d,l,n),a(f,l,d),a(u,l,f),a(n,l,u),a(f,d,k)]})();(function(){function a(a,b,c){var d=new THREE.Matrix4;d.set(a.x,b.x,c.x,0,a.y,b.y,c.y,0,a.z,b.z,c.z,0,0,0,0,1);return d}function b(a,b){return(a.n14*b.x+a.n24*b.y+a.n34*b.z)/c}twistyjs.registerTwisty("pyr",function(a,f){function g(a,b){return 3<=Math.abs(b[2])&&3<=Math.abs(b[3])}var h=new THREE.Object3D,l=[],k={stickerBorder:!0,stickerWidth:1.8,doubleSided:!0,opacity:1,dimension:3,faceColors:[],scale:1};for(n in k)n in f&&(k[n]=f[n]);var n=[];for(var B=new THREE.MeshBasicMaterial({color:0,wireframe:!0,
wireframeLinewidth:1,opacity:k.opacity}),u=0;u<w;u++)n.push(new THREE.MeshBasicMaterial({color:k.faceColors[u],opacity:k.opacity}));for(u=0;u<w;u++){var E=[];l.push(E);for(var D=0;D<r.length;D++){curf=r[D];var M=new THREE.Object3D,H=[n[u]];k.stickerBorder&&H.push(B);for(var T=[],I=0;I<curf[0].length;I++)T[I]=[curf[0][I][0]*c,curf[0][I][1]*c];H=new THREE.Mesh(new THREE.Ploy(T),H);H.doubleSided=k.doubleSided;M.addChild(H);H=(new THREE.Matrix4).setRotationAxis(z[u],d*curf[4]).multiplySelf(m[u]).multiplySelf((new THREE.Matrix4).setTranslation(curf[1]*
c,curf[2]*c,curf[3]*c));M.matrix.copy(H);M.matrixAutoUpdate=!1;M.update();E.push([H,M]);h.addChild(M)}}n=.5*k.scale/k.dimension;h.scale=new THREE.Vector3(n,n,n);var L={73:[C,-1,-3,0],75:[C,1,-3,0],87:[O,-1,-3,0],79:[O,1,-3,0],83:[O,-1,-3,-1],76:[O,1,-3,-1],68:[F,-1,-3,0],69:[F,1,-3,0],74:[A,-1,-3,0],70:[A,1,-3,0],72:[A,-1,-3,-1],71:[A,1,-3,-1],186:[A,-1,-3,3],59:[A,-1,-3,3],65:[A,1,-3,3],85:[C,-1,-3,-1],77:[C,1,-3,-1],82:[F,1,-3,-1],86:[F,-1,-3,-1],84:[F,1,-3,3],89:[C,-1,-3,3],78:[C,1,-3,3],66:[F,
-1,-3,3],80:[O,1,-3,3],81:[O,-1,-3,3]},N=0,P=-1;return{type:f,options:k,_3d:h,cubePieces:l,animateMoveCallback:function(a,c,f,g){f=new THREE.Matrix4;var h=z[c[0]];f.setRotationAxis(h,d/3*-g*c[1]);a=a.cubePieces;for(g=0;g<w;g++)for(var l=a[g],k=0,q=l.length;k<q;k++){var p=l[k],m=b(p[1].matrix,h);m>c[2]&&m<c[3]&&(p[1].matrix.multiply(f,p[1].matrix),p[1].update())}},advanceMoveCallback:function(a,c){g(a,c)||c[0]==P||N++;P=c[0];var f=new THREE.Matrix4,h=z[c[0]];f.setRotationAxis(h,-(d/3*c[1]));for(var l=
a.cubePieces,k=0;k<w;k++)for(var q=l[k],p=0,m=q.length;p<m;p++){var t=q[p],n=b(t[1].matrix,h);n>c[2]&&n<c[3]&&(t[0].multiply(f,t[0]),t[1].matrix.copy(t[0]),t[1].update())}},keydownCallback:function(b,c){if(!c.altKey&&!c.ctrlKey){var d=c.keyCode;d in L&&a.addMoves([L[d]])}},isSolved:function(c){if(!a.isMoveFinished())return 1;c=c.cubePieces;for(var d=0;d<w-1;d++)for(var f=c[d],g=new THREE.Vector3(f[0][0].n13,f[0][0].n23,f[0][0].n33),h=b(f[0][0],g),l=1,k=f.length;l<k;l++)if(.1<Math.abs(b(f[l][0],g)-
h))return 1;return 0},isInspectionLegalMove:g,isParallelMove:function(a,b,c){return b[0]==c[0]},generateScramble:function(a){return[]},parseScramble:function(a){if(a.match(/^\s*$/))return[];var b=kernel.parseScramble(a,"URLB");a=[];for(var c=0;c<b.length;c++)a.push([b[c][0],b[c][2]-2,-3,1-b[c][1]]);return a},moveCnt:function(a){a&&(N=0,P=-1);return N},move2str:function(a){var b=a[0],c=-1==a[1]?"'":"";a=a[3]-a[2];return 6==a?"["+"urlb".charAt(b)+c+"]":2==a?"urlb".charAt(b)+c:"URLB".charAt(b)+c}}});
var c=2.5,d=Math.TAU,g=new THREE.Vector3(0,-1,0),h=new THREE.Vector3(-Math.sqrt(6)/3,1/3,-Math.sqrt(2)/3),f=new THREE.Vector3(Math.sqrt(6)/3,1/3,-Math.sqrt(2)/3),l=new THREE.Vector3(0,1/3,Math.sqrt(8)/3),n=1/Math.sqrt(3),k=[[0,n-.07],[-(1-.07/n)/2,-(n-.07)/2],[(1-.07/n)/2,-(n-.07)/2]],u=Math.sqrt(6)/4,r=[[k,0,-n,u,0],[k,0,-n,u,1/6],[k,0,-n,u,2/6],[k,0,-n,u,.5],[k,0,-n,u,4/6],[k,0,-n,u,5/6],[k,0,2*n,u,1/6],[k,0,2*n,u,.5],[k,0,2*n,u,5/6]],w=4,z=[g,h,f,l],m=[a(new THREE.Vector3(1,0,0),new THREE.Vector3(0,
0,1),g),a(new THREE.Vector3(-.5,0,Math.sqrt(3)/2),new THREE.Vector3(-Math.sqrt(3)/6,-2*Math.sqrt(2)/3,-1/6),h),a(new THREE.Vector3(-.5,0,-Math.sqrt(3)/2),new THREE.Vector3(Math.sqrt(3)/6,-2*Math.sqrt(2)/3,-1/6),f),a(new THREE.Vector3(1,0,0),new THREE.Vector3(0,-Math.sqrt(8)/3,1/3),l)],A=0,C=1,F=2,O=3})();(function(){function a(a,b,c){var d=new THREE.Matrix4;d.set(a.x,b.x,c.x,0,a.y,b.y,c.y,0,a.z,b.z,c.z,0,0,0,0,1);return d}function b(a,b){return(a.n14*b.x+a.n24*b.y+a.n34*b.z)/c}twistyjs.registerTwisty("mgm",function(a,f){function g(a,b){return 3<=Math.abs(b[2])&&3<=Math.abs(b[3])}var h=new THREE.Object3D,l=[],k={stickerBorder:!0,stickerWidth:1.8,doubleSided:!0,opacity:1,dimension:3,faceColors:[],scale:1};for(q in k)q in f&&(k[q]=f[q]);var q=[];for(var p=new THREE.MeshBasicMaterial({color:0,wireframe:!0,
wireframeLinewidth:1,opacity:k.opacity}),m=0;m<G;m++)q.push(new THREE.MeshBasicMaterial({color:k.faceColors[m],opacity:k.opacity}));for(m=0;m<G;m++){var n=[];l.push(n);for(var v=0;v<t.length;v++){curf=t[v];var r=new THREE.Object3D,u=[q[m]];k.stickerBorder&&u.push(p);for(var w=[],z=0;z<curf[0].length;z++)w[z]=[curf[0][z][0]*c,curf[0][z][1]*c];u=new THREE.Mesh(new THREE.Ploy(w),u);u.doubleSided=k.doubleSided;r.addChild(u);u=(new THREE.Matrix4).setRotationAxis(B[m],d*curf[4]).multiplySelf(J[m]).multiplySelf((new THREE.Matrix4).setTranslation(curf[1]*
c,curf[2]*c,curf[3]*c));r.matrix.copy(u);r.matrixAutoUpdate=!1;r.update();n.push([u,r]);h.addChild(r)}}q=.5*k.scale/k.dimension;h.scale=new THREE.Vector3(q,q,q);var A={73:[M,1,1,3],75:[M,-1,1,3],68:[H,1,1,3],69:[H,-1,1,3],74:[E,1,1,3],70:[E,-1,1,3],72:[Q,1,1,3],71:[Q,-1,1,3],186:[E,1,-3,3],59:[E,1,-3,3],65:[E,-1,-3,3],85:[H,-1,-3,1],82:[M,1,-3,1],77:[H,1,-3,1],86:[M,-1,-3,1],84:[H,-1,-3,3],89:[M,1,-3,3],78:[M,-1,-3,3],66:[H,1,-3,3],80:[Q,1,-3,3],81:[Q,-1,-3,3]},C=0,D=-1;return{type:f,options:k,_3d:h,
cubePieces:l,animateMoveCallback:function(a,c,f,g){f=new THREE.Matrix4;var h=B[c[0]];f.setRotationAxis(h,d/5*-g*c[1]);a=a.cubePieces;for(g=0;g<G;g++)for(var k=a[g],l=0,q=k.length;l<q;l++){var p=k[l],m=b(p[1].matrix,h);m>c[2]&&m<c[3]&&(p[1].matrix.multiply(f,p[1].matrix),p[1].update())}},advanceMoveCallback:function(a,c){g(a,c)||c[0]==D||C++;D=c[0];var f=new THREE.Matrix4,h=B[c[0]];f.setRotationAxis(h,-(d/5*c[1]));for(var l=a.cubePieces,k=0;k<G;k++)for(var q=l[k],p=0,m=q.length;p<m;p++){var t=q[p],
n=b(t[1].matrix,h);n>c[2]&&n<c[3]&&(t[0].multiply(f,t[0]),t[1].matrix.copy(t[0]),t[1].update())}},keydownCallback:function(b,c){if(!c.altKey&&!c.ctrlKey){var d=c.keyCode;d in A&&a.addMoves([A[d]])}},isSolved:function(c){if(!a.isMoveFinished())return 1;c=c.cubePieces;for(var d=0;d<G-1;d++)for(var f=c[d],g=new THREE.Vector3(f[0][0].n13,f[0][0].n23,f[0][0].n33),h=b(f[0][0],g),k=1,l=f.length;k<l;k++)if(.1<Math.abs(b(f[k][0],g)-h))return 1;return 0},isInspectionLegalMove:g,isParallelMove:function(a,b,
c){return b[0]==c[0]},generateScramble:function(a){return[]},parseScramble:function(a){if(a.match(/^\s*$/))return[];var b=a.match(/[RD](?:\+\+|--)|U'?/g);a=[];for(var c=0;c<b.length;c++)switch(b[c]){case "R++":a.push([H,-2,-3,1]);break;case "R--":a.push([H,2,-3,1]);break;case "D++":a.push([E,-2,-3,1]);break;case "D--":a.push([E,2,-3,1]);break;case "U":a.push([E,1,1,3]);break;case "U'":a.push([E,-1,1,3])}return a},moveCnt:function(a){a&&(C=0,D=-1);return C},move2str:function(a){var b=a[0],c=a[1];a=
a[3]-a[2];if(6==a)return"["+"ufr??l??????".charAt(b)+(0<c?"":"'")+"]";if(4==a)return"D?L??R??????".charAt(b)+(0<c?"-":"+");if(2==a)return"UFR??L??????".charAt(b)+(0<c?"":"'")}}});var c=2.8,d=Math.TAU,g=function(a){return Math.sin(a*d)},h=function(a){return Math.cos(a*d)},f=1/Math.sqrt(5),l=new THREE.Vector3(0,1,0),n=new THREE.Vector3(0,f,2*f),k=new THREE.Vector3(2*f*g(.2),f,2*f*h(.2)),u=new THREE.Vector3(2*f*g(.4),f,2*f*h(.4)),r=new THREE.Vector3(2*f*g(.6),f,2*f*h(.6)),w=new THREE.Vector3(2*f*g(.8),
f,2*f*h(.8)),z=new THREE.Vector3(0,-1,0),m=new THREE.Vector3(0,-f,-2*f),A=new THREE.Vector3(-2*f*g(.2),-f,-2*f*h(.2)),C=new THREE.Vector3(-2*f*g(.4),-f,-2*f*h(.4)),F=new THREE.Vector3(-2*f*g(.6),-f,-2*f*h(.6)),O=new THREE.Vector3(-2*f*g(.8),-f,-2*f*h(.8)),I=Math.PI,D=.275/Math.tan(I/5),q=[[.45*Math.sin(0*I),.45*-Math.cos(0*I)],[.45*Math.sin(.4*I),.45*-Math.cos(.4*I)],[.45*Math.sin(.8*I),.45*-Math.cos(.8*I)],[.45*Math.sin(1.2*I),.45*-Math.cos(1.2*I)]];I=[[.45*Math.sin(0*I),.45*-Math.cos(0*I)],[.45*
Math.sin(1.2*I),.45*-Math.cos(1.2*I)],[.45*Math.sin(1.6*I),.45*-Math.cos(1.6*I)]];var p=[[.45*g(.1)-.05*g(.05),.55*h(.1)-.05-.2],[-.45*g(.1)+.05*g(.05),.55*h(.1)-.05-.2],[g(-.1)-.275/g(-.1)-.05*g(.05),.05-.2],[g(.1)-.275/g(.1)+.05*g(.05),.05-.2]];D=[[0,.05/h(.1)-.2],[D-.05/g(.1),.275-.2],[0,.55-.05/h(.1)-.2],[-D+.05/g(.1),.275-.2]];var v=2*(Math.cos(Math.PI/5)+Math.cos(Math.PI/5)*Math.cos(Math.PI/5)-.05)/Math.sqrt(5),t=[[p,0,.2-h(.1),v,.1],[p,0,.2-h(.1),v,.3],[p,0,.2-h(.1),v,.5],[p,0,.2-h(.1),v,.7],
[p,0,.2-h(.1),v,.9],[D,0,-.8,v,0],[D,0,-.8,v,.2],[D,0,-.8,v,.4],[D,0,-.8,v,.6],[D,0,-.8,v,.8],[q,0,0,v,0],[I,0,0,v,0]],G=12,B=[l,n,k,u,r,w,z,m,A,C,F,O],J=[a(new THREE.Vector3(-1,0,0),new THREE.Vector3(0,0,1),l),a(new THREE.Vector3(1,0,0),new THREE.Vector3(0,2*f,-f),n),a(new THREE.Vector3(h(.2),0,-g(.2)),new THREE.Vector3(-g(.2)*f,2*f,-f*h(.2)),k),a(new THREE.Vector3(h(.4),0,-g(.4)),new THREE.Vector3(-g(.4)*f,2*f,-f*h(.4)),u),a(new THREE.Vector3(h(.6),0,-g(.6)),new THREE.Vector3(-g(.6)*f,2*f,-f*h(.6)),
r),a(new THREE.Vector3(h(.8),0,-g(.8)),new THREE.Vector3(-g(.8)*f,2*f,-f*h(.8)),w),a(new THREE.Vector3(1,0,0),new THREE.Vector3(0,0,-1),z),a(new THREE.Vector3(-1,0,0),new THREE.Vector3(0,-2*f,f),m),a(new THREE.Vector3(-h(.2),0,g(.2)),new THREE.Vector3(g(.2)*f,-2*f,f*h(.2)),A),a(new THREE.Vector3(-h(.4),0,g(.4)),new THREE.Vector3(g(.4)*f,-2*f,f*h(.4)),C),a(new THREE.Vector3(-h(.6),0,g(.6)),new THREE.Vector3(g(.6)*f,-2*f,f*h(.6)),F),a(new THREE.Vector3(-h(.8),0,g(.8)),new THREE.Vector3(g(.8)*f,-2*f,
f*h(.8)),O)],E=0,Q=1,M=2,H=5})();window.twistyjs.qcube=function(){function a(a,b,c,d){var f=d*d,g,h,k;5<a&&(a-=6);for(k=0;k<c;k++){for(g=0;g<d;g++){if(0==a){var q=6*f-d*b-d+g;var m=2*f-d*b-1-g;var p=3*f-d*b-1-g;var n=5*f-d*b-d+g}else 1==a?(q=3*f+b+d*g,m=3*f+b-d*(g+1),p=f+b-d*(g+1),n=5*f+b+d*g):2==a?(q=3*f+b*d+g,m=4*f+d-1-b+d*g,p=b*d+d-1-g,n=2*f-1-b-d*g):3==a?(q=4*f+b*d+d-1-g,m=2*f+b*d+g,p=f+b*d+g,n=5*f+b*d+d-1-g):4==a?(q=6*f-1-b-d*g,m=d-1-b+d*g,p=2*f+d-1-b+d*g,n=4*f-1-b-d*g):5==a&&(q=4*f-d-b*d+g,m=2*f-d+b-d*g,p=f-1-b*d-g,n=4*f+b+
d*g);var v=l[q];l[q]=l[m];l[m]=l[p];l[p]=l[n];l[n]=v}if(0==b)for(g=0;g+g<d;g++)for(h=0;h+h<d-1;h++)q=a*f+g+h*d,p=a*f+(d-1-g)+(d-1-h)*d,3>a?(m=a*f+(d-1-h)+g*d,n=a*f+h+(d-1-g)*d):(n=a*f+(d-1-h)+g*d,m=a*f+h+(d-1-g)*d),v=l[q],l[q]=l[m],l[m]=l[p],l[p]=l[n],l[n]=v}}function b(){for(var a=0;a<k;a++){var b=k-1-a,c=[[0,0,1,1],[a,a+1,a+1,a]];0!=a&&(f(D,n[l[(1*k+a)*k]],c,[A,m,k+2*m]),f(D,n[l[(4*k+a)*k]],c,[A,k+1+3*m,k+2*m]));a!=k-1&&(f(D,n[l[1*k*k+b]],c,[A,m+0,m+0]),f(D,n[l[4*k*k+b]],c,[A,m+k+1+2*m,m]));for(b=
0;b<k;b++)c=[[a,a,a+1,a+1],[b,b+1,b+1,b]],f(D,n[l[(3*k+b)*k+a]],c,[A,1+2*m,m]),f(D,n[l[(5*k+b)*k+a]],c,[A,1+2*m,k+2*m])}a=[[0,0,1,1],[0,2+m,2+m,0]];f(D,n[l[1*k*k]],a,[A,m,m+k-1]);f(D,n[l[4*k*k]],a,[A,k+1+3*m,m+k-1]);5<k&&(f(D,"#fff",[[-.1,-.1,.1,.1],[-.1,.1,.1,-.1]],[A,.5*k+1+2*m,.5*k+m]),f(D,"#fff",[[-.1,-.1,.1,.1],[-.1,.1,.1,-.1]],[A,.5*k+1+2*m,1.5*k+2*m]))}function c(a,b,c){return{73:[1,b,"R",1],75:[1,b,"R",-1],87:[1,1,"B",1],79:[1,1,"B",-1],83:[1,1,"D",1],76:[1,1,"D",-1],68:[1,a,"L",1],69:[1,
a,"L",-1],74:[1,1,"U",1],70:[1,1,"U",-1],72:[1,1,"F",1],71:[1,1,"F",-1],186:[1,c,"U",1],59:[1,c,"U",1],65:[1,c,"U",-1],85:[1,b+1,"R",1],82:[1,a+1,"L",-1],77:[1,b+1,"R",-1],86:[1,a+1,"L",1],84:[1,c,"L",-1],89:[1,c,"R",1],78:[1,c,"R",-1],66:[1,c,"L",1],190:[2,2,"R",1],88:[2,2,"L",-1],53:[2,2,"L",1],54:[2,2,"R",-1],80:[1,c,"F",1],81:[1,c,"F",-1],90:[1,2,"D",1],67:[1,2,"U",-1],188:[1,2,"U",1],191:[1,2,"D",-1]}}function d(c){for(var d=0;d<c.length;d++){for(var f=c[d],h=0;h<u.length;h++)u[h](f,0),u[h](f,
1);var l="DLBURF".indexOf(f[2]),m=(f[3]+3)%4+1;for(h=f[0];h<f[1];h++)a(l,h-1,m,k);f[1]==k?a((l+3)%6,0,4-m,k):a(l,f[1]-1,m,k);h=f;g(h)||h[2]==O||F++;O=h[2];for(h=0;h<u.length;h++)u[h](f,2)}b()}function g(a){return 1==a[0]&&a[1]==k}var h,f=$.ctxDrawPolygon,l=[],n="#ff0 #fa0 #00f #fff #f00 #0d0".split(" "),k=3,u=[],r=1,w=1,z=k,m=.1,A=30,C=c(r,w,z),F=0,O=-1,I=$('<div style="width:100%; height:100%;"/>'),D;return{keydown:function(a){if(!a.altKey&&!a.ctrlKey){a=a.keyCode;var b=!1;if(51==a||52==a||55==a||
56==a||32==a)51==a?r=Math.max(1,r-1):52==a?r=Math.min(r+1,z-1):55==a?w=Math.min(w+1,z-1):56==a?w=Math.max(1,w-1):32==a&&(r=w=1),C=c(r,w,z),b=!0;a in C&&d([C[a]]);return b}},addMoveListener:function(a){u.push(a)},getDomElement:function(){return I},resize:function(){if(h){m=.1*Math.sqrt(k/3);var a=k+2+4*m,c=2*k+3*m,d=Math.min($(I).width()/a,$(I).height()/c);A=Math.max(10,d);h.width(a*d);h.height(c*d);h.attr("width",a*A);h.attr("height",c*A);b()}},addMoves:function(a){return d(a)},applyMoves:d,isRotation:g,
move2str:function(a){var b=a[2],c=a[1],d=(a[3]+3)%4;return c==z?"yxz".charAt("URFDLB".indexOf(a[2])%3)+" 2'".charAt(-1=="URF".indexOf(a[2])?2-d:d):2==a[0]?"2-2"+a[2]+"w"+" 2'".charAt(d):(2<c?c:"")+b+(2<=c?"w":"")+" 2'".charAt(d)},toggleColorVisible:function(a){},isSolved:function(a){if(3==k){var b=[],c=k*k;for(a=0;6>a;a++)for(var d=0;d<k;d++)for(var f=0==a?k-1-d:d,g=0;g<k;g++)b[(a+3)%6*c+d*k+g]="DLBURF".charAt(l[a*c+f*k+(1==a||2==a?k-1-g:g)]);return cubeutil.getProgress(b.join(""),kernel.getProp("vrcMP",
"n"))}for(g=b=0;6>g;g++)for(c=l[b],a=0;a<k*k;a++)if(l[b++]!=c)return 1;return 0},moveCnt:function(a){a&&(F=0,O=-1);return F},parseScramble:function(a){if(a.match(/^\s*$/)){a=[];for(var b=0;32>b;b++){var c=1+~~(Math.random()*k/2);a.push([c,c+~~(Math.random()*k/2),"ULFRBD".split("")[~~(6*Math.random())],[-2,-1,1,2][~~(4*Math.random())]])}return a}b=kernel.parseScramble(a,"URFDLB");a=[];for(c=0;c<b.length;c++)0<b[c][1]?a.push([1,b[c][1],"URFDLB".charAt(b[c][0]),[1,2,-1][b[c][2]-1]]):a.push([1,3,"URFDLB".charAt(b[c][0]),
[1,2,-1][-b[c][2]-1]]);return a},init:function(a){if(!h){h=$("<canvas>");if(!h[0].getContext)return;h.appendTo(I);D=h[0].getContext("2d")}k=a.dimension;w=r=1;z=k;C=c(r,w,z);for(var b=a=0;6>b;b++)for(var d=0;d<k*k;d++)l[a++]=b}}}();
